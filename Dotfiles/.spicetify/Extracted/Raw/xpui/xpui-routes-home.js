"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[807],{70369:(e,t,n)=>{n.d(t,{$:()=>r.$});var r=n(22578)},89091:(e,t,n)=>{n.r(t),n.d(t,{HOME_REFRESH_TIMEOUT:()=>Be,default:()=>Me});var r=n(67294),a=n.n(r),l=n(94184),o=n.n(l),i=n(65858),c=n(76092),s=n(7041),u=n(1663),m=n(20657),d=n(95989),f=n(29255),g=n(5001),E=n(89294),p=n(92457),y=n(70369),h=n(13983),v=n(35808),b=n(17231),_=n(8247),w=n(24872),k=n(35533),P=n(33607),I=n(80624),T=n(74845),S=n(23716);const C="PLAY_AT_FIRST_TAP_HAD_DEFERRED_ACTIONS",A=e=>{const t=(0,w.getEventSenderInstance)(),n=(0,k.x)(e);t.send(n)};function O(e){const t=(0,b.W6)(_.Qs),[n,a]=(0,r.useState)(void 0),[l,o]=(0,r.useState)(void 0),[c,s]=(0,r.useState)(!1),u=(0,S.g)(),m=(0,i.v9)((({session:e})=>e.user&&e.user.id));(0,r.useEffect)((()=>{o(!!window.sessionStorage.getItem(C)&&(window.sessionStorage.removeItem(C),!0))}),[]),(0,r.useEffect)((()=>{m&&(A({category:"play-at-first-tap",label:"log_attempt",os:(0,P.y)(),context:"ab_v3"}),s((e=>!!window.sessionStorage.getItem(`PLAY_AT_FIRST_TAP_APPLIED_${e}`))(m)),(0,T.M)(I.b.getInstance()).then((e=>{a(e.content.items.length>0)})).catch((()=>{A({category:"play-at-first-tap",label:"recently-played-failed",os:(0,P.y)(),context:"ab_v3"}),a(!0)})))}),[m]),(0,r.useEffect)((()=>{if(void 0===n||void 0===l||!e||!m||c)return;const r=!n&&!l;if(r){(e=>{window.sessionStorage.setItem(`PLAY_AT_FIRST_TAP_APPLIED_${e}`,JSON.stringify(!0))})(m);const n=(e=>{const t=e.content.items.find((e=>{const t="CAROUSEL"===e.rendering,n="LIST"===e.rendering&&"shortcuts"!==e.id;return t||n}));if(!t)return;const n=t.content.items.find((e=>!e.publisher||!e.publisher.startsWith("Spotify")));return n&&n.uri})(e);n&&t&&u.play({uri:n},{featureIdentifier:"home",referrerIdentifier:"home"},{paused:!0}),A({category:"play-at-first-tap",label:"play_content",os:(0,P.y)(),context:n||"no_valid_uri_retrieved"})}A({category:"play-state",label:r?"has_valid_state_yes":"has_valid_state_no",os:(0,P.y)(),context:"ab_v3"})}),[c,n,e,l,u,m,t])}var L=n(1496),N=n(73526);const F="rPV8BmHZXaGIGT2HwvBB",x="nlOU1unbFAd7ZHyeSMTH",U="jb9xD5ECTqKFK02qe3HZ",D="Z35BWOA10YGn5uc9YgAp",R="g3f_cI5usQX7ZOQyDtA9",B="jvWzgRWM_y_9FFTYRCcB",M="zXwER4Lsqq_e7fVVaPkZ",H="WWDxafTPs4AgThdcX5jN",W="CKxS_0I5yf3i15WAjzvE",j="Tzzq1pG_inwo_oSOdyjb",G="EzRmGRncgnv1zFgF4dqE",z="bPmmKmSPLKMhtJSaUJRX",Y="Kcb74zm1aMqGfPxTwO5s",q="s9c9x_mJq197U2hBzGtV";var J=n(76343),V=n(50114),Z=n(17213),K=n(13218),X=n(63926),$=n(73012),Q=n(69559),ee=n(67154),te=n.n(ee),ne=n(69518),re=n.n(ne),ae=n(28342),le=n(91362),oe=n(68156),ie=n(37077),ce=n(18261),se=n(13020),ue=n(61202),me=n(56802),de=n(18171),fe=n(55911),ge=n(46245),Ee=n(67892),pe=n(49961),ye=n(80418);const he=a().memo((({images:e=[],fallbackIcon:t=ae.e})=>{const n=(0,pe.X)(e),r=null!=n&&n.url?M:W;return a().createElement("div",{className:B},a().createElement("div",{className:r},a().createElement(ye.E,{className:H,src:null==n?void 0:n.url,loading:"lazy",testid:"shortcut-image"},a().createElement(t,{"aria-hidden":!0}))))}));var ve=n(70296),be=n(84242),_e=n(34325),we=n(18061),ke=n(43864);const Pe=a().memo((({index:e,item:t,fallbackIcon:n,showPlayButton:l,onContextMenu:i=(()=>{}),onTouchStart:c=(()=>{}),onTouchEnd:s=(()=>{})})=>{var u,m;const d=(0,ue.k6)(),f=(0,me.o)(),{setColorFromUri:g,resetColor:E}=(0,ve.WQ)(),p=(0,_e.G3)(t.uri,t.release_date,null===(u=t.resume_point)||void 0===u?void 0:u.resume_position_ms,null===(m=t.resume_point)||void 0===m?void 0:m.fully_played),{spec:y,logger:h}=(0,L.fU)(ke.createDesktopShortcutsPlayNavCardEventFactory,{data:{position:e,uri:t.uri}}),{isPlaying:v,isActive:b,togglePlay:w}=(0,be.n)({uri:t.uri},{featureIdentifier:"home",referrerIdentifier:"home"});function k(){f({targetUri:t.uri,intent:v?"pause":"play",type:"click"});const e=y.playButtonFactory();let n;n=v?e.hitPause({itemToBePaused:t.uri}):b?e.hitResume({itemToBeResumed:t.uri}):e.hitPlay({itemToBePlayed:t.uri}),h.logInteraction(n),w()}const P=(0,r.useCallback)((()=>{f({targetUri:t.uri,intent:"navigate",type:"click"});const e=y.hitUiNavigate({destination:t.uri});h.logInteraction(e),d.push(re().from(t.uri).toURLPath(!0))}),[d,t.uri,h,f,y]),I=(0,r.useCallback)((()=>{g(t.uri)}),[t.uri,g]),T=(0,L.Wi)(y);return a().createElement("div",{ref:T,className:D,onContextMenu:i,onTouchStart:c,onTouchEnd:s,onMouseEnter:I,onMouseLeave:E},a().createElement(de.Z,{uri:t.uri,text:t.name,extraClassName:R},a().createElement(he,{images:t.images,fallbackIcon:n}),a().createElement("div",{className:j},a().createElement(Ee.r,{to:t.uri,onClick:P,title:t.name},a().createElement(J.Dy.p,{variant:J.Dy.balladBold,className:G},t.name)),p&&a().createElement(_e.Rd,{className:z}),l&&a().createElement("div",{className:o()(Y,{[q]:v})},a().createElement(we.F,{property:_.iY,renderOldExperience:()=>a().createElement(fe.JM,{size:fe.qE.sm,isPlaying:v,onClick:k}),renderNewExperience:()=>a().createElement(ge.fh,{isPlaying:v,onClick:k})}))),a().createElement("div",{onClick:P,className:U})))}));var Ie=n(4232),Te=n(80507),Se=n(86514),Ce=n(25988);const Ae=a().memo((e=>re().isCollection(e.item.uri)?a().createElement(Pe,te()({},e,{fallbackIcon:ae.e})):a().createElement(ce._,{menu:a().createElement(se.X,{uri:e.item.uri})},a().createElement(Pe,te()({},e,{fallbackIcon:ae.e}))))),Oe=a().memo((e=>a().createElement(ce._,{menu:a().createElement(Ie.Y,{uri:e.item.uri})},a().createElement(Pe,te()({},e,{fallbackIcon:le.u}))))),Le=a().memo((e=>a().createElement(ce._,{menu:a().createElement(Te.m,{uri:e.item.uri})},a().createElement(Pe,te()({},e,{fallbackIcon:oe.i}))))),Ne=a().memo((e=>a().createElement(ce._,{menu:a().createElement(Se.M,{uri:e.item.uri})},a().createElement(Pe,te()({},e,{fallbackIcon:ie.n,showPlayButton:!1}))))),Fe=a().memo((e=>a().createElement(ce._,{menu:a().createElement(Ce.k,{uri:e.item.uri})},a().createElement(Pe,te()({},e,{fallbackIcon:ie.n,showPlayButton:!1})))));var xe=n(4236);const Ue=a().memo((({tagline:e,items:t})=>{const{fetchMultipleColors:n}=(0,ve.WQ)(),[l,i]=(0,r.useState)(270),c=!(0,xe.k)(),s=(0,r.useRef)(null),u=(()=>{const e=(new Date).getHours();let t=m.ag.get("home.evening");return e>=5&&e<12?t=m.ag.get("home.morning"):e>=12&&e<18&&(t=m.ag.get("home.afternoon")),t})(),d=(0,r.useCallback)((()=>{const e=s.current;if(null==e||!e.parentElement)return;const t=(n=e.parentElement.offsetWidth)<700?240:n>=700&&n<1400?270:300;var n;t!==l&&i(t)}),[l]);(0,Q.a)((()=>{d()})),(0,r.useLayoutEffect)((()=>{d()})),(0,r.useEffect)((()=>{const e=(null==t?void 0:t.map(ve.lh))||[];n(e)}),[t,n]);const f=(0,r.useCallback)(((e,n)=>{if(null==t||!t.length)return null;const r=n>=270;return a().createElement(a().Fragment,null,t.filter(((t,n)=>n<2*e)).map(((e,t)=>{const n=function(e){const t=(re().from(e)||{}).type;switch(t){case re().Type.ARTIST:return Le;case re().Type.ALBUM:case re().Type.COLLECTION_ALBUM:return Oe;case re().Type.PLAYLIST:case re().Type.PLAYLIST_V2:return Ae;case re().Type.SHOW:return Ne;case re().Type.EPISODE:return Fe;case re().Type.COLLECTION:return Ae;default:return console.warn(`Unable to resolve entity shortcut from ${e} of type "${t||"unknown"}"`),Ne}}(e.uri);return a().createElement(n,{index:t,key:e.id,item:e,showPlayButton:r,shouldSetBackgroundColor:0===t})})))}),[t]);return c||null==t||!t.length?null:a().createElement("section",{className:F,"aria-label":u,ref:s},a().createElement(K.r,{title:u,titleVariant:J.Dy.alto,tagline:e}),a().createElement(X.T,{className:o()(x),columnAware:!0,render:f,minimumColumnWidth:l,rowGap:$.o78}))})),De=(0,V.P)(Ue,(()=>null),(e=>(0,Z.v)({from:"HomeShortcutsGrid",error:e})));var Re=n(42922);const Be=18e5,Me=a().memo((()=>{const{isAnonymous:e}=(0,i.v9)(f.Gg),{status:t}=(0,p.h)(E.N9.SIGNUP),n=(0,g.v8)(e,t===E.b_.COMPLETE),{view:l,refreshContents:b}=(0,v.P)(n),{spec:_,UBIFragment:w}=(0,L.fU)(N.createDesktopHomeEventFactory,{data:{identifier:n,uri:"spotify:home"}});(0,h.z)("home"),O(l);const k=(null==l?void 0:l.timestamp)||0;(0,r.useEffect)((()=>{const e=()=>{Date.now()>k+Be&&b()};return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}}),[k,b]);const P=null==l?void 0:l.content.items,[I,T]=(0,r.useMemo)((()=>{const e=[];let t=null;if(Array.isArray(P))for(let n=0;n<P.length;n++){const r=P[n];"shortcuts"===r.id?t=r:e.push(r)}return[t,e]}),[P]);return a().createElement(w,{spec:_},a().createElement(y.$,null,m.ag.get("page.generic-title")),a().createElement(r.Suspense,{fallback:null},a().createElement(s.SearchOnHomeTopBar,null)),l?a().createElement("section",{"data-testid":"home-page"},a().createElement("div",{className:c.Z.home},a().createElement("div",{className:o()(c.Z.content,"contentSpacing")},I?a().createElement(w,{spec:_.shortcutsFactory()},a().createElement(Re.JL,{value:"headered-grid",key:I.id},a().createElement(De,{items:I.content.items,title:I.name,tagline:I.tag_line}))):null,a().createElement(w,{spec:_.shelvesFactory()},a().createElement(d.c,{spaces:T,viewName:l.name,viewId:n,isAnonymous:e}))))):a().createElement(u.h,{errorMessage:m.ag.get("error.not_found.title.page")}))}))},95989:(e,t,n)=>{n.d(t,{c:()=>k});var r=n(59713),a=n.n(r),l=n(67294),o=n.n(l),i=n(21794),c=n(1150),s=n(42922),u=n(56661),m=n(5001),d=n(67154),f=n.n(d),g=n(6479),E=n.n(g),p=n(1496),y=n(25949),h=n(19480);const v=["index","id"],b=e=>{let{index:t,id:n}=e,r=E()(e,v);const{seeAllUri:a}=r,{spec:i,logger:c,UBIFragment:s}=(0,p.fU)(y.createDesktopShelfEventFactory,{data:{identifier:n,position:t}}),u=(0,l.useCallback)((()=>{const e=i.shelfHeaderFactory().shelfHeaderTitleFactory().hitUiNavigate({destination:null!=a?a:""});c.logInteraction(e)}),[c,a,i]),m=(0,l.useCallback)((()=>{const e=i.shelfHeaderFactory().shelfHeaderSeeAllFactory().hitUiNavigate({destination:null!=a?a:""});c.logInteraction(e)}),[c,a,i]),d=(0,p.Wi)(i);return o().createElement(s,{spec:i},o().createElement(h.P,f()({},r,{onClickShelfTitle:u,onClickShelfSeeAll:m,elementRef:d})))};function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const k=({spaces:e,viewName:t,viewId:n,isAnonymous:r})=>{const a=(0,l.useCallback)((e=>{const t=((e,t)=>{let{uri:n}=e;return e.href.includes("https://api.spotify.com/v1/views/")&&(n=e.href.replace("https://api.spotify.com/v1/views/","spotify:genre:"),n.endsWith("-page")||(n+="-page"),"hub-browse-grid"===t&&(n=n.replace(":view:",":genre:"))),n})(e,n),r=(0,u.U)(t);return o().createElement(r,{key:e.href,entity:w(w({},e),{},{uri:t})})}),[n]),d=(0,l.useCallback)(((e,t)=>{const n=(0,u.U)(e.uri);return o().createElement(s.JL,{key:e.uri||t,value:"card",index:t},o().createElement(n,{entity:e}))}),[]),f=(0,l.useCallback)(((e,t)=>"link"===e.type?a(e):d(e,t)),[d,a]),g=(0,l.useCallback)((e=>!((e=>"HEADER"===e.rendering)(e)||0===e.content.total||r&&"uniquely-yours-shelf"===e.id)),[r]);return e&&0!==e.length?e[0].content?o().createElement(o().Fragment,null,e.filter(g).map(((e,t)=>{const r=e.content&&(0,i.p)((0,i.S)(e.href));return e.id===c.RECENTLY_PLAYED_VIEW_ID||e.id===m.uK?o().createElement(s.JL,{value:"headered-grid",index:t,key:e.id},o().createElement(c.RecentlyPlayed,{showAll:!1})):o().createElement(s.JL,{value:"headered-grid",index:t,key:e.id},o().createElement(b,{total:e.content.total,seeAllUri:r,pageId:n,title:e.name,tagline:e.tag_line||void 0,index:t,id:e.id},e.content.items.map(f)))}))):o().createElement(s.JL,{value:"headered-grid"},o().createElement(b,{showAll:!0,title:t,total:(null==e?void 0:e.length)||0,index:0,id:null!=n?n:"spaces-see-all-grid"},null==e?void 0:e.map(f))):null}},35808:(e,t,n)=>{n.d(t,{P:()=>c});var r=n(94321),a=n(29255),l=n(67294),o=n(65858),i=n(43088);const c=e=>{const t=(0,i.n)(),[n,c]=(0,l.useState)((()=>t.getViewFromCache(e))),s=(0,o.v9)(r.r),{locale:u,overrides:m}=(0,o.v9)(a.Gg),d=(null==m?void 0:m.country)||s,f=(null==m?void 0:m.locale)||u;(0,l.useEffect)((()=>{t.getView(e,{country:d,locale:f}).then((e=>{c(e)}))}),[d,f,e,t]);return{view:n,getNextPage:(0,l.useCallback)((()=>{t.getMore(e).then((e=>{e&&c(e)}))}),[e,t]),refreshContents:(0,l.useCallback)((()=>{t.getView(e,{country:d,locale:f,ignoreCache:!0}).then((e=>{c(e)}))}),[d,f,e,t])}}}}]);
//# sourceMappingURL=xpui-routes-home.js.map