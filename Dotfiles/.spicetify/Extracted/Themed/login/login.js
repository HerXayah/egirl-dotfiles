(()=>{var e,t={3982:(e,t,n)=>{"use strict";var r={};n.r(r),n.d(r,{ENTER_LOGIN_MODE:()=>S,ENTER_SETTINGS_MODE:()=>k,ENTER_SIGNUP_MODE:()=>E,ENTER_SIGNUP_MODE_STEP_0:()=>y,ENTER_SIGNUP_MODE_STEP_1:()=>_,ENTER_WELCOME_MODE:()=>w,INTERACTION:()=>v,START_APP:()=>b,enterLoginMode:()=>I,enterSettingsMode:()=>D,enterSignupMode:()=>P,enterSignupModeStep0:()=>C,enterSignupModeStep1:()=>T,enterWelcomeMode:()=>N,interaction:()=>F,openSignupPage:()=>A,startApp:()=>O});var o={};n.r(o),n.d(o,{ABORT_LOGIN_TYPE_ACCOUNTS:()=>de,ACCOUNTS_METHODS:()=>ue,LOADING:()=>re,LOGIN_BEFORE:()=>Q,LOGIN_CLEAR_ERRORS:()=>te,LOGIN_FAIL:()=>ne,LOGIN_SUCCESS:()=>ee,LOGIN_TYPE_ACCOUNTS:()=>ce,LOGIN_TYPE_AUTOLOGIN:()=>le,LOGIN_TYPE_EMAIL:()=>ae,LOGIN_TYPE_FACEBOOK:()=>se,LOGIN_TYPE_FACEBOOK_POPUP:()=>ie,UTM_PARAMETERS:()=>oe,abortLoginWithAccounts:()=>ye,fetchUTMParameters:()=>Se,loading:()=>me,login:()=>be,loginClearErrors:()=>ke,loginFailed:()=>he,loginSuccess:()=>ge,loginWithAccounts:()=>Ee,loginWithFacebookPopup:()=>_e,receivedUTMParameters:()=>we});var a={};n.r(a),n.d(a,{CLEAR_ALL_ERRORS:()=>ze,COUNTRY_NOT_LAUNCHED:()=>qe,FACEBOOK_SIGNUP_ATTEMPT:()=>Be,FACEBOOK_SIGNUP_FAILURE:()=>Ve,FACEBOOK_SIGNUP_SUCCESS:()=>$e,SIGNUP_ATTEMPT:()=>Ue,SIGNUP_FAILURE:()=>je,SIGNUP_RESTRICTIONS_FAILURE:()=>xe,SIGNUP_RESTRICTIONS_SUCCESS:()=>Re,SIGNUP_SUCCESS:()=>Ge,UPDATE_SIGNUP_DATA:()=>Ke,VALIDATE_FIELD_ATTEMPT:()=>We,VALIDATE_FIELD_FAILURE:()=>He,VALIDATE_FIELD_SUCCESS:()=>Ye,clearAllErrors:()=>gt,countryNotLaunched:()=>pt,facebookSignup:()=>at,facebookSignupFailure:()=>it,facebookSignupSuccess:()=>st,getSignupRestrictions:()=>Xe,signup:()=>Qe,signupAttempt:()=>tt,signupFailure:()=>rt,signupRestrictionsFailure:()=>Je,signupRestrictionsSuccess:()=>Ze,signupSuccess:()=>nt,signupWithAccounts:()=>ot,updateSignupData:()=>ut,validateField:()=>et,validateFieldAttempt:()=>lt,validateFieldFailure:()=>ct,validateFieldSuccess:()=>dt});var s={};n.r(s),n.d(s,{SETTINGS_FETCH_PROXY_SETTINGS_FAILURE:()=>It,SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS:()=>Tt,SETTINGS_RESTART_CLIENT_FAILURE:()=>Ft,SETTINGS_RESTART_CLIENT_SUCCESS:()=>At,SETTINGS_UPDATE_PROXY_SETTINGS_FAILURE:()=>Dt,SETTINGS_UPDATE_PROXY_SETTINGS_SUCCESS:()=>Nt,fetchProxySettings:()=>Mt,restartClient:()=>Rt,updateProxySettings:()=>Lt});var i=n(7294),l=n.n(i),c=n(3935),d=n.n(c),u=n(7209),p=n(5858),g=n(2976),h=n(685),m=n(9713),f=n.n(m);const b="START_APP",E="ENTER_SIGNUP_MODE",y="ENTER_SIGNUP_MODE_STEP_0",_="ENTER_SIGNUP_MODE_STEP_1",S="ENTER_LOGIN_MODE",w="ENTER_WELCOME_MODE",k="ENTER_SETTINGS_MODE",v="INTERACTION";function O(){return{type:b}}function P(e=null){return{type:E,actionHash:e}}function C(){return{type:y}}function T(){return{type:_}}function I(e=null){return{type:S,actionHash:e}}function N(e=null){return{type:w,errorMessage:e}}function D(){return{type:k}}function A(e=!1){return(t,n)=>{const r=n();let o,a={};switch(e?"website":"desktop-app"){case"desktop-app":t(P());break;case"website":{a=r.login.utmParameters||{utm_source:"spotify",utm_medium:"desktop-unknown",utm_campaign:"organic",referral:""};const e=Object.keys(a).reduce(((e,t)=>(e[t]=encodeURIComponent(a[t]),e)),{});o=`https://www.spotify.com/signup?utm_source=${e.utm_source}&utm_medium=${e.utm_medium}&utm_campaign=${e.utm_campaign}`,e.referral&&(o+=`&referral=${e.referral}&referrer=${e.referral}`),window.open(o);break}}}}function F(e,t,n,r,o){return{type:v,page:e,interactionType:t,intent:n,itemId:r,actionHash:o}}const M=e=>n.g&&"function"==typeof n.g._getSpotifyModule?new Promise(((t,r)=>{n.g._getSpotifyModule("bridge").executeRequest(JSON.stringify(e),{onSuccess:t,onFailure:r})})):null,L="https://www.spotify.com/redirect/account-page/",R="showSettings",x={id:"UnknownLoginErrorMessage"},U={id:"DefaultErrorMessage",replace:[R]},j={id:"FbFailureOpenPopup",silent:!0},G={127:{id:"SessionTerminatedMessage"},3:{id:"BadCredentialsMessage"},4:{id:"ErrorResolvingDNS"},53:{id:"ErrorProxyUnauthorized"},54:{id:"ErrorProxyForbidden"},55:{id:"ErrorProxyAuthRequired",replace:[R]},400:x,401:x,402:{id:"CriticalUpdate"},403:{id:"UserBannedMessage"},404:x,405:x,406:{id:"UserNotAllowedOnPlatformMessage"},407:{id:"MissingUserInfoMessage",replace:[L]},408:{id:"RegionMismatchMessage",replace:[L,"https://www.spotify.com/redirect/upgrade-product/"]},409:{id:"PremiumUsersOnlyMessage"},410:{id:"BadCredentialsMessage"},411:x,412:{id:"BadCredentialsMessage"},413:{id:"CreateUserDeniedMessage"},414:x,415:x,416:x,417:{id:"FacebookCredentialsMisusedMessage"},418:x,"critical-update-error":{id:"ClientUpdateFail",replace:["https://www.spotify.com/redirect/download/"]},1001:{silent:!0},1002:j,1003:{id:"FbUserNotFoundSignUp",replace:["showSignup"]},1004:j,1005:j,1006:j},B={1:x,2:x,3:{id:"BadCredentialsMessage"},4:x,5:x,6:x,7:x,8:x,9:x},$={1:{silent:!0},2:x,3:x,4:{id:"SessionExpiredMessage"},5:U},V=window.localStorage;function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Y="lastUsername",K="THIS_USER_DOES_NOT_EXIST_AND_IS_A_PLACEHOLDER",q="utmParameters",z=V.getItem(q),X=V.getItem(Y),Z={errorData:null,loginInProgress:!1,redirectTo:null,username:X!==K?X:"",utmParameters:z?JSON.parse(z):null};const J=function(e=Z,t){switch(t.type){case jt.LOADING:return H(H({},e),{},{loading:!0,throbberDelay:t.throbberDelay});case jt.LOGIN_FAIL:return H(H({},e),{},{loading:!1,errorData:t.errorData,loggedIn:!1,loginInProgress:!1});case jt.LOGIN_BEFORE:return H(H({},e),{},{errorData:t.errorData,loggedIn:!1,loginInProgress:t.loginInProgress,username:t.username});case jt.LOGIN_SUCCESS:return H(H({},e),{},{loading:!1,loggedIn:!0,redirectDelay:t.redirectDelay||0,redirectTo:t.redirectTo,username:t.username});case jt.UTM_PARAMETERS:return H(H({},e),{},{utmParameters:t.utmParameters});case jt.LOGIN_CLEAR_ERRORS:return H(H({},e),{},{errorData:null});default:return e}},Q="LOGIN_BEFORE",ee="LOGIN_SUCCESS",te="LOGIN_CLEAR_ERRORS",ne="LOGIN_FAIL",re="LOADING",oe="UTM_PARAMETERS",ae="login",se="login-facebook",ie="login-facebook-popup",le="autologin",ce="login-accounts",de="abort-login-accounts",ue={facebook:"facebook",apple:"apple",google:"google"};function pe(e,t=ae){return{type:Q,errorData:null,username:e||"",loginInProgress:t===ae,loginType:t}}function ge(e,t,n=ae,r=!1,o){return{type:ee,errorData:null,redirectTo:o,redirectDelay:t||0,username:e,loginType:n,afterSignup:r}}function he(e,t=ae){return{type:ne,errorData:e,loginType:t}}function me(e){return{type:re,throbberDelay:e&&e.throbberDelay?e.throbberDelay:0}}const fe=async(e,t,{defaultErrorCode:n,redirectDelay:r=0}={},o=ae,a=!1,s=null,i=!0)=>{s&&(t.args=t.args||[],t.args[0]=t.args[0]||{},t.args[0].actionHash=s);try{const n=JSON.parse(await M(t)).redirectTo||"xpui";let s=null;t&&t.args&&t.args[0]&&(s=t.args[0].username),e(ge(i?s:K,r,o,a,n))}catch(t){let r=t;n?r={errorCode:n}:"string"==typeof t&&(r=JSON.parse(t)),r.errorCode&&G[r.errorCode]&&"FbFailureOpenPopup"===G[r.errorCode].id?e(_e(s)):e(he(r,o))}};function be({username:e,password:t,rememberMe:n},r=!1,o=null){return a=>{const s=r?le:ae;a(pe(n?e:K,s));fe(a,{name:ae,args:[{username:e,password:t,rememberMe:n}]},{redirectDelay:200},s,r,o,n)}}function Ee(e,t){return n=>{n(pe(null,ce));fe(n,{name:ce,args:[{method:e,enableSignup:!1}]},{redirectDelay:200},ce,!1,t)}}function ye(){return async()=>{await M({name:de,args:[]})}}function _e(e=null){return t=>{t(pe(null,se));fe(t,{name:ie,args:[]},{redirectDelay:200},se,!1,e)}}function Se(){return async e=>{e(we(JSON.parse(await M({name:"get-signup-utm-parameters",args:[]}))))}}function we(e){return{type:oe,utmParameters:e}}function ke(){return{type:te}}var ve=n(6479),Oe=n.n(ve),Pe=n(8495),Ce=n.n(Pe);const Te=["errors"];function Ie(){const e="undefined"!=typeof window&&window.__spotify&&window.__spotify.DESKTOP_SIGNUP_DEBUG_KEY;return e||"4c7a36d5260abca4af282779720cf631"}function Ne(){const e="undefined"!=typeof window&&window.__spotify&&window.__spotify.client_version||"";if(!e)throw new Error("Missing Spotify App Version! Something is wrong: talk to #desktop-squad.");return["Spotify-App-Version",e]}function De(){const e="undefined"!=typeof window&&window.navigator&&window.navigator.platform||"";let t="";if(-1!==e.indexOf("Mac")?t="OSX":-1!==e.indexOf("Win")?t="Win32":-1!==e.indexOf("Linux")&&(t="Linux"),!t)throw new Error("Missing App Platform! Something is wrong: talk to #desktop-squad.");return["App-Platform",t]}function Ae(e){const t=new Map(Object.entries(e).sort()),n=function(e){const t=Ce().create();return e.forEach((e=>{void 0!==e&&t.update(e.toString())})),t.hex()}(t);if(t.size>n.length)return t;const r=[...t],o=[...Array(t.size).keys()].sort((function(e,t){const o=n.charAt(e).localeCompare(n.charAt(t));return 0!==o?o:r[e][0].localeCompare(r[t][0])})),a=new Map;return o.forEach((function(e){a.set(r[e][0],r[e][1])})),a}const Fe=e=>async(t,n,r)=>{const o=function({name:e,email:t,password:n,gender:r,birthDate:o={},sendEmail:a,shareData:s,agreeEula:i}={},l={utm_source:"spotify",utm_medium:"desktop-unknown",utm_campaign:"organic",referral:""},c=!1){const d=Object.keys(l).reduce(((e,t)=>(e[t]=encodeURIComponent(l[t]),e)),{});let u=`https://login.app.spotify.com?utm_source=${d.utm_source}&utm_medium=${d.utm_medium}&utm_campaign=${d.utm_campaign}`;d.referral&&(u+=`&referral=${d.referral}&referrer=${d.referral}`);const p={key:Ie(),displayname:e,email:t,password:n,password_repeat:n,gender:r,birth_year:o.year,birth_month:o.month,birth_day:o.day,iagree:i?1:0,creation_point:u,creation_flow:"desktop",platform:"desktop",referrer:d.referral};return"boolean"==typeof a&&(p["send-email"]=a),"boolean"==typeof s&&(p.thirdpartyemail=s),c&&Object.keys(p).forEach((e=>{void 0===p[e]&&delete p[e]})),Ae(p)}(t,n,r),a=new FormData;o.forEach(((e,t)=>{a.append(t,e)}));const s=[Ne(),De()].reduce(((e,t)=>(e[t[0]]=t[1],e)),{}),i={method:"POST",body:a,headers:{"App-Platform":s["App-Platform"],"Spotify-App-Version":s["Spotify-App-Version"],"X-Client-Id":{NODE_ENV:"production",DEBUG_EVENT_SENDER:!1,DEBUG_SEMANTIC_METRICS:void 0,PRODUCT_NAME:"desktop"}.SPOTIFY_CLIENT_ID}},l=new Request(e,i);((e,t)=>{const n=e.headers.get("content-type");e.headers.set("content-type",((e,t)=>[...e.split(";"),t].join(";"))(n,t))})(l,"charset=utf-8");const c=await fetch(l),d=await c.json()||{},{errors:u}=d,p=Oe()(d,Te);if(u)throw u;return p},Me=Fe("https://spclient.wg.spotify.com/signup/public/v1/account/"),Le=Fe("https://spclient.wg.spotify.com/signup/public/v1/account/?validate=true");const Re="SIGNUP_RESTRICTIONS_SUCCESS",xe="SIGNUP_RESTRICTIONS_FAILURE",Ue="SIGNUP_ATTEMPT",je="SIGNUP_FAILURE",Ge="SIGNUP_SUCCESS",Be="FACEBOOK_SIGNUP_ATTEMPT",$e="FACEBOOK_SIGNUP_SUCCESS",Ve="FACEBOOK_SIGNUP_FAILURE",We="VALIDATE_FIELD_ATTEMPT",He="VALIDATE_FIELD_FAILURE",Ye="VALIDATE_FIELD_SUCCESS",Ke="UPDATE_SIGNUP_DATA",qe="COUNTRY_NOT_LAUNCHED",ze="CLEAR_ALL_ERRORS";function Xe(){return async(e,t)=>{const n=t();try{e(Ze(window.__spotify&&!0===window.__spotify.is_running_on_teamcity?{}:await(async()=>{const e=await fetch("https://spclient.wg.spotify.com/signup/public/v1/account/?validate=1"),t=await e.json()||{};if(t.errors&&t.errors.length>0)throw t.errors;return t})()))}catch(t){e(Je(t)),n.app&&n.app.mode&&"welcome"!==n.app.mode&&(e(I()),e(A(!0)))}}}function Ze(e){return{type:Re,restrictions:e}}function Je(e){return{type:xe,error:e}}function Qe(e=null){return async(t,n)=>{t(tt());const r=n().signup.formData,o=n().login.utmParameters;try{await Me(r,o),t(nt());const{email:n,password:a}=r;t(be({username:n,password:a,rememberMe:!0},!0,e))}catch(e){const n={};Object.keys(e).forEach((t=>{n["birthdate"===t?"birthDate":t]={message:e[t]}})),t(rt(n))}}}function et(e){return async(t,n)=>{const r=n().signup.formData[e],o=n().login.utmParameters;t(lt(e,r));try{await Le({[e]:r},o,!0)}catch(n){n[e]&&t(ct(e,{message:n[e]}))}}}function tt(){return{type:Ue}}function nt(){return{type:Ge}}function rt(e){return{type:je,errors:e}}function ot(e,t=null){return n=>{const r={name:ce,args:[{method:e,enableSignup:!0}]};n(at()),(async(e,t,n=null)=>{n&&(t.args=t.args||[],t.args[0]=t.args[0]||{},t.args[0].actionHash=n);try{const n=JSON.parse(await M(t)).redirectTo||"xpui";e(st()),e(ge(null,0,le,!0,n))}catch(t){let n=t;"string"==typeof t&&(n=JSON.parse(t)),e(it(n))}})(n,r,t)}}function at(){return{type:Be}}function st(){return{type:$e}}function it(e){return{type:Ve,errorData:e}}function lt(e,t){return{type:We,field:e,value:t}}function ct(e,t){return{type:He,field:e,error:t}}function dt(e){return{type:Ye,field:e}}function ut(e){return{type:Ke,data:e}}function pt(){return{type:qe}}function gt(){return{type:ze}}let ht,mt,ft;!function(e){e.af="af",e.am="am",e.ar="ar",e.az="az",e.bg="bz",e.bn="bn",e.bho="bho",e.cs="cs",e.da="da",e.de="de",e.el="el",e.en="en",e.es419="es-419",e.es="es",e.et="et",e.fa="fa",e.fi="fi",e.fil="fil",e.frCA="fr-CA",e.fr="fr",e.gu="gu",e.he="he",e.hi="hi",e.hr="hr",e.hu="hu",e.id="id",e.is="is",e.it="it",e.ja="ja",e.kn="kn",e.ko="ko",e.lt="lt",e.lv="lv",e.ml="ml",e.mr="mr",e.ms="ms",e.nb="bn",e.ne="ne",e.nl="nl",e.or="or",e.paIN="pa-IN",e.paPK="pa-PK",e.pl="pl",e.ptBR="pt-BR",e.ptPT="pa-PT",e.ro="ro",e.ru="ru",e.sk="sk",e.sl="sl",e.sr="sr",e.sv="sv",e.sw="sw",e.ta="ta",e.te="te",e.th="th",e.tr="tr",e.uk="uk",e.ur="ur",e.vi="vi",e.zhCN="zh-CN",e.zhTW="zh-TW",e.zu="zu"}(ht||(ht={})),function(e){e.AR="، ",e.FA="، ",e.EN=", "}(mt||(mt={})),function(e){e.ZERO="zero",e.ONE="one",e.TWO="two",e.FEW="few",e.MANY="many",e.OTHER="other"}(ft||(ft={}));let bt={};function Et(e){return"number"==typeof e?e.toString():e.replace(/\$/,"$$$$")}const yt=e=>"ar"===e?"ar-u-nu-latn":e;class _t{constructor(){f()(this,"_locale",void 0),f()(this,"_dictionary",void 0),this._dictionary={},this._locale=ht.en}setDictionary(e){this._dictionary=e}setLocale(e){this._locale=e}getLocale(){return this._locale}toLocaleLowerCase(e){return null==e?void 0:e.toLocaleLowerCase(this._locale)}toLocaleUpperCase(e){return null==e?void 0:e.toLocaleUpperCase(this._locale)}get(e,...t){const n=e in this._dictionary?this._dictionary[e]:e;let r="";if("string"!=typeof n){const e=t[0],o=((e,t)=>{try{return(bt[e]||(bt[e]=new Intl.PluralRules(e))).select(t)}catch{return ft.OTHER}})(this._locale,parseInt(e,10)),a=n[o];void 0!==a?r=a:n.other&&(r=n.other)}else r=n;if(/%\d%/.test(r)){if(!["desktop.login.DefaultErrorMessage","desktop.login.ErrorProxyAuthRequired","desktop.login.MissingUserInfoMessage","desktop.login.RegionMismatchMessage","desktop.login.ClientUpdateFail","desktop.login.FbUserNotFoundSignUp","desktop.login.errorCode","desktop-auth.error"].includes(e))throw new Error("i18n: The placeholder format %0% is legacy and is only allowed for existing strings.")}if((null==t?void 0:t.length)>0)for(let e=0;e<t.length;e++){const n=t[e];if(null!=n)if("string"==typeof n)r=r.replace(`{${e}}`,Et(n)).replace(`%${e}%`,Et(n));else if("number"==typeof n){const t=this.formatNumber(n);r=r.replace(`{${e}}`,t).replace(`%${e}%`,t)}else if("object"==typeof n)for(const e of Object.keys(n)){const t=n[e];r=r.replace(`%${e}%`,Et(t))}}return r}getSeparator(){switch(this._locale){case ht.ar:return mt.AR;case ht.fa:return mt.FA;default:return mt.EN}}formatNumber(e,t){return e.toLocaleString(yt(this._locale),t)}formatNumberCompact(e,t){const n={notation:"compact",maximumFractionDigits:1};if(t){const r=new _t;return r.setLocale(t),r.formatNumber(e,n)}return this.formatNumber(e,n)}formatDate(e,t=null){const n=t||{year:"numeric",month:"long",day:"numeric"};return new Intl.DateTimeFormat(yt(this._locale),n).format(e)}formatRelativeDate(e,t=null){var n;const r=new Date(Date.now()),o=(e=new Date(e)).getTime()-r.getTime();if(Math.abs(o)<2592e6&&null!==(n=Intl)&&void 0!==n&&n.RelativeTimeFormat){const{days:e,hours:t,minutes:n,seconds:r}=(a=o,{seconds:Math.round(a/1e3),minutes:Math.round(a/1e3/60),hours:Math.round(a/1e3/60/60),days:Math.round(a/1e3/60/60/24)}),s=new Intl.RelativeTimeFormat;return e||t||n?e||t?e?s.format(e,"days"):s.format(t,"hours"):s.format(n,"minutes"):s.format(r,"seconds")}var a;return this.formatDate(e,t)}__resetForTests(){this._dictionary={},this._locale=ht.en,bt={}}}const St=new _t,wt=2,kt=3,vt=4,Ot={"auto-detect":{label:()=>St.get("desktop.settings.proxy.autodetect")},"no-proxy":{label:()=>St.get("desktop.settings.proxy.noproxy")},http:{label:()=>St.get("desktop.settings.proxy.http")},socks4:{label:()=>St.get("desktop.settings.proxy.socks4")},socks5:{label:()=>St.get("desktop.settings.proxy.socks5")}},Pt=[{enumKey:"auto-detect",enumValue:0},{enumKey:"no-proxy",enumValue:1},{enumKey:"http",enumValue:2},{enumKey:"socks4",enumValue:3},{enumKey:"socks5",enumValue:4}],Ct="sp://proxy/v1/";const Tt="SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS",It="SETTINGS_FETCH_PROXY_SETTINGS_FAILURE",Nt="SETTINGS_UPDATE_PROXY_SETTINGS_SUCCESS",Dt="SETTINGS_UPDATE_PROXY_SETTINGS_FAILURE",At="SETTINGS_RESTART_CLIENT_SUCCESS",Ft="SETTINGS_RESTART_CLIENT_FAILURE";function Mt(){return e=>{(async function(){return new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"GET",uri:Ct}),persistent:!1,onSuccess:n=>{const r=JSON.parse(n);200!==r.status&&t(new Error(`Failed to fetch proxy settings (status code: ${r.status})`));const o=JSON.parse(r.body);e({mode:o["network.proxy.mode"],address:o["network.proxy.addr"],username:o["network.proxy.user"],password:o["network.proxy.pass"]})},onFailure:(e,n)=>{t(e)}})}))})().then((t=>{e(function(e){return{type:Tt,data:e}}(t))}),(t=>{e(function(e){return{type:It,error:e}}(t))}))}}function Lt(e){return t=>{(async function(e){return new Promise(((t,n)=>{const r={"network.proxy.mode":e.mode};[wt,kt,vt].includes(e.mode)&&(r["network.proxy.addr"]=e.address,r["network.proxy.user"]=e.username),[wt,vt].includes(e.mode)&&(r["network.proxy.pass"]=e.password),window.sendCosmosRequest({request:JSON.stringify({method:"PUT",uri:Ct,body:JSON.stringify(r)}),persistent:!1,onSuccess:()=>{t()},onFailure:(e,t)=>{n(e)}})}))})(e).then((()=>{t({type:Nt}),t(Mt())}),(e=>{t(function(e){return{type:Dt,error:e}}(e))}))}}function Rt(){return e=>{(async function(){return new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"POST",uri:"sp://desktop/v1/restart"}),persistent:!1,onSuccess:()=>{e()},onFailure:(e,n)=>{t(e)}})}))})().then((()=>{e({type:At})}),(t=>{e(function(e){return{type:Ft,error:e}}(t))}))}}function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const jt=Ut(Ut(Ut(Ut({},r),o),a),s);n(5697);class Gt extends l().Component{constructor(e){super(e),this.state={hidden:this.props.delay>0}}componentDidMount(){!0===this.state.hidden&&(this.throbberTimeout=setTimeout((()=>{this.setState({hidden:!1})}),this.props.delay))}componentWillUnmount(){this.throbberTimeout&&clearTimeout(this.throbberTimeout)}render(){return this.state.hidden?null:l().createElement("div",{className:"GlueThrobber "+(this.props.initial?"throbber-initial":"throbber")},l().createElement("div",null))}}Gt.defaultProps={delay:0,initial:!0};var Bt=n(2808),$t=n.n(Bt);function Vt(){return $t().create().toString()}var Wt=n(8455);class Ht extends l().PureComponent{constructor(e){super(e),this.handleLoginClick=this.handleLoginClick.bind(this),this.handleErrorClick=this.handleErrorClick.bind(this)}handleLoginClick(){const e=Vt();this.props.openLoginPage(e),this.props.onInteraction("login/welcome","click","open-page-login",null,e)}handleErrorClick(e){if(e.target.getAttribute("data-action")){"showSettings"===e.target.getAttribute("data-action")&&this.props.openSettingsPage()}}render(){const{errorMessage:e}=this.props;return l().createElement("main",{className:"Welcome"},l().createElement("h1",{className:"HeroText __welcome"},St.get("desktop-auth.login.millions-of-songs"),l().createElement("br",null),St.get("desktop-auth.login.free-on-spotify")),l().createElement("div",{className:"Welcome__signup-or-login"},e&&l().createElement("div",{className:"Welcome__error-message",role:"alert",onClick:this.handleErrorClick,"aria-live":"assertive"},l().createElement(Wt.Z,{className:"Welcome__error-message__icon"}),l().createElement("span",{dangerouslySetInnerHTML:{__html:e}})),l().createElement("button",{type:"button",className:"Welcome__button button button-green button-large",id:"login-button",onClick:this.handleLoginClick,"data-ta-id":"welcome-login-button","data-testid":"login-button"},St.get("desktop.login.LoginButton"))))}}const Yt=(0,p.$j)((e=>({errorMessage:e.app.errorMessage})),(e=>({openLoginPage:t=>e(jt.enterLoginMode(t)),openSettingsPage:()=>e(jt.enterSettingsMode()),onInteraction:(t,n,r,o,a)=>e(jt.interaction(t,n,r,o,a))})))(Ht);var Kt=n(7396),qt=n(7060),zt=n(4184),Xt=n.n(zt);function Zt(e,t,n){if(0===t)return!1;if(!e&&!t)return!1;let r=G;switch(e){case"session":r=B;break;case"desktop_login_accounts":r=$}const o=r[t]||U;if(o.silent)return!1;const a=o.replace||[];let s="";switch(o.id){case"UnknownLoginErrorMessage":s=St.get("desktop.login.UnknownLoginErrorMessage");break;case"DefaultErrorMessage":s=St.get("desktop.login.DefaultErrorMessage",a[0]);break;case"SessionTerminatedMessage":s=St.get("desktop.login.SessionTerminatedMessage");break;case"SessionExpiredMessage":s=St.get("desktop.login.SessionExpiredMessage");break;case"BadCredentialsMessage":s=St.get("desktop.login.BadCredentialsMessage");break;case"ErrorResolvingDNS":s=St.get("desktop.login.ErrorResolvingDNS");break;case"ErrorProxyUnauthorized":s=St.get("desktop.login.ErrorProxyUnauthorized");break;case"ErrorProxyForbidden":s=St.get("desktop.login.ErrorProxyForbidden");break;case"ErrorProxyAuthRequired":s=St.get("desktop.login.ErrorProxyAuthRequired",a[0]);break;case"CriticalUpdate":s=St.get("desktop.login.CriticalUpdate");break;case"UserBannedMessage":s=St.get("desktop.login.UserBannedMessage");break;case"UserNotAllowedOnPlatformMessage":s=St.get("desktop.login.UserNotAllowedOnPlatformMessage");break;case"MissingUserInfoMessage":s=St.get("desktop.login.MissingUserInfoMessage",a[0]);break;case"RegionMismatchMessage":s=St.get("desktop.login.RegionMismatchMessage",a[0],a[1]);break;case"PremiumUsersOnlyMessage":s=St.get("desktop.login.PremiumUsersOnlyMessage");break;case"CreateUserDeniedMessage":s=St.get("desktop.login.CreateUserDeniedMessage");break;case"ClientUpdateFail":s=St.get("desktop.login.ClientUpdateFail",a[0]);break;case"FbUserNotFoundSignUp":s=St.get("desktop.login.FbUserNotFoundSignUp",a[0])}return`${s}<br>${St.get("desktop.login.errorCode",n)}`}function Jt({validity:e={}}){return e.valid?null:["valueMissing","typeMismatch","tooShort"].find((t=>e[t]))}const Qt=()=>l().createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8ZM7.25 3V10H8.75V3H7.25ZM7.25 11.5256V13.0256H8.75V11.5256H7.25Z",fill:"#eb6471"}));class en extends l().PureComponent{render(){const{errorMessage:e}=this.props;return l().createElement("div",{"aria-live":"polite",className:Xt()("FieldError",{"FieldError--hidden":!e})},l().createElement(Qt,null),l().createElement("span",null,e||""))}}let tn=0;class nn extends l().PureComponent{constructor(...e){super(...e),this.idNumber=++tn,this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.onChange(e)}render(){const{label:e,placeholderLabel:t,name:n,type:r,isRequired:o,taId:a,id:s,defaultValue:i,value:c,minLength:d,autoFocus:u,hasError:p,isDisabled:g,isHiddenForScreenReaders:h,useCustomStyle:m,className:f,inputClassName:b,inputRef:E,onBlur:y,onFocus:_,onInput:S,onKeyDown:w,onKeyUp:k}=this.props,v=s||`GlueTextInput-${this.idNumber}`;return l().createElement("label",{className:m?f:"GlueTextInput",htmlFor:v,"aria-label":e,"aria-hidden":!!h||void 0},l().createElement("input",{className:m?b:Xt()("GlueTextInput__input",{"GlueTextInput__input--has-error":p}),tabIndex:h?"-1":void 0,type:r,id:v,name:n,"data-ta-id":a,"aria-invalid":p,disabled:g,minLength:d,autoFocus:u,placeholder:t||e,value:i?void 0:c,defaultValue:i,onBlur:y,onFocus:_,onChange:this.handleChange,onInput:i?void 0:S,onKeyDown:w,onKeyUp:k,ref:E,required:o}))}}nn.defaultProps={name:"",type:"text",isRequired:!1,taId:"",defaultValue:void 0,value:"",minLength:0,autoFocus:!1,hasError:!1,isDisabled:!1,isHiddenForScreenReaders:!1,useCustomStyle:!1,onBlur(){},onFocus(){},onChange(){},onInput(){},onKeyDown(){}};class rn extends l().PureComponent{constructor(e){super(e),f()(this,"handleTogglePasswordVisible",(()=>{const e=!this.state.passwordVisible;this.setState({passwordVisible:e}),this.props.onTogglePasswordVisibility&&this.props.onTogglePasswordVisibility(e)})),this.state={isEditing:!1,passwordVisible:!1},this.handleBlur=this.handleBlur.bind(this),this.handleInput=this.handleInput.bind(this)}handleBlur({target:e,relatedTarget:t}){this.setState({isEditing:!1}),t&&(t.name||"submit"===t.type)&&this.validate(e)}handleInput(){this.setState({isEditing:!0})}validate(e){const{name:t,onValidate:n,noValidate:r}=this.props;!r&&n&&n(t,Jt(e))}renderPasswordEyeToggler(){const{type:e}=this.props,{passwordVisible:t}=this.state;return"password"!==e?null:l().createElement(l().Fragment,null,l().createElement("button",{type:"button",onClick:this.handleTogglePasswordVisible,tabIndex:"-1",className:"FormField--passwordEyeIcon "+(t?"passwordVisible":"")}),l().createElement("span",{tabIndex:"-1",className:"FormField--passwordEyeIcon--cross "+(t?"passwordVisible":"")}))}render(){const{error:e={},noValidate:t,label:n,name:r,type:o,value:a,isRequired:s,minLength:i,autoFocus:c,isDisabled:d,onChange:u,onKeyUp:p,onFocus:g,rightIcon:h=null}=this.props,{isEditing:m,passwordVisible:f}=this.state,b=h;let E=o;return"password"===o&&f&&(E="text"),l().createElement("div",{className:Xt()("FormField",{"FormField--no-validate":t})},l().createElement(nn,{label:n,name:r,type:E,taId:`${r}-field`,value:a,isRequired:s,minLength:i,autoFocus:c,hasError:!!e.message&&!m,isDisabled:d,onChange:u,onFocus:g,onKeyUp:p,onBlur:this.handleBlur,onInput:this.handleInput}),b&&l().createElement(b,{className:"FormField--rightIcon"}),this.renderPasswordEyeToggler(),!t&&!m&&e.message&&l().createElement(l().Fragment,null,l().createElement(en,{errorMessage:e.message})))}}const on=(0,p.$j)((()=>({})),(()=>({})))(rn);var an=n(7154),sn=n.n(an);const ln=["type","name","label","classes","hasError"];class cn extends l().PureComponent{constructor(...e){super(...e),this.handleBlur=this.handleBlur.bind(this)}handleBlur(e={}){this.props.onBlur&&this.props.onBlur(e)}render(){const e=this.props,{type:t="text",name:n,label:r,classes:o,hasError:a}=e,s=Oe()(e,ln),i=`${n}-field`;return l().createElement("span",{className:o},l().createElement("label",{className:"glue-hidden-visually",htmlFor:i},r),l().createElement("input",sn()({},s,{onBlur:this.handleBlur,type:t,name:n,id:i,"data-ta-id":i,className:Xt()("form-control Input",{"Input--has-error":a}),"aria-invalid":!!a,placeholder:r,required:!0})))}}const dn=(e,t,n)=>{let r=null;return((e,t,n)=>[e,t,n].reduce(((e,t)=>e&&!!t),!0))(e,t,n)?((e,t,n)=>{const r=new Date(n,t-1,e);return r.getDate()===e&&r.getMonth()===t-1&&r.getFullYear()===n})(e,t,n)||(r="invalid"):r="incomplete",r};function un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?un(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const gn={BIG_ENDIAN:"big",LITTLE_ENDIAN:"little",MIDDLE_ENDIAN:"middle"};class hn extends l().PureComponent{constructor(e){super(e),this.state={isEditing:!1},this.monthStrings=[St.get("desktop.login.January"),St.get("desktop.login.February"),St.get("desktop.login.March"),St.get("desktop.login.April"),St.get("desktop.login.May"),St.get("desktop.login.June"),St.get("desktop.login.July"),St.get("desktop.login.August"),St.get("desktop.login.September"),St.get("desktop.login.October"),St.get("desktop.login.November"),St.get("desktop.login.December")],this.handleInput=this.handleInput.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this)}handleInput({target:{name:e,value:t,validity:n={}}}){this.setState({isEditing:!0}),n.valueMissing?this.props.onChange(pn(pn({},this.props.value),{},{[e]:void 0})):(n.valid||n.rangeUnderflow)&&this.props.onChange(pn(pn({},this.props.value),{},{[e]:parseInt(t,10)}))}handleBlur(e){const t=e.relatedTarget?e.relatedTarget.name:null,n=["day","month","year"].includes(t);this.setState({isEditing:n}),n||this.validate()}handleFocus(e){this.setState({isEditing:!0});const t=e.relatedTarget?e.relatedTarget.name:null;!["day","month","year"].includes(t)&&this.props.onFocus&&this.props.onFocus()}validate(){const{day:e,month:t,year:n}=this.props.value,r=dn(e,t,n,this.props.minAge);this.props.onValidate("birthDate",r)}renderYear(e,t,n){return l().createElement(cn,{type:"number",name:"year",classes:"FormDate__input FormDate__year",label:St.get("desktop.login.Year"),autoFocus:n,defaultValue:e||"",onInput:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,min:1900,hasError:t.includes("year"),onFocus:this.handleFocus})}renderMonth(e,t,n){return l().createElement("select",{name:"month",id:"month-field",className:Xt()("form-control Input FormDate__input FormDate__month",{"Input--has-error":t.includes("month")}),autoFocus:n,defaultValue:e||"",required:!0,onChange:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,onFocus:this.handleFocus},l().createElement("option",{value:"",disabled:!0,hidden:!0},St.get("desktop.login.Month")),this.monthStrings.map(((e,t)=>l().createElement("option",{value:t+1,key:t},e))))}renderDay(e,t,n){return l().createElement(cn,{type:"number",name:"day",classes:"FormDate__input FormDate__day",label:St.get("desktop.login.Day"),autoFocus:n,defaultValue:e||"",onInput:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,min:1,max:31,hasError:t.includes("day"),onFocus:this.handleFocus})}render(){const{name:e,label:t,dateEndianness:n,error:r={},autoFocus:o}=this.props,{day:a,month:s,year:i}=this.props.value,{isEditing:c}=this.state,d=["day","month","year"].filter((e=>!(c||!r.message)&&("incomplete"===r.code?!this.props.value[e]:"tooOld"!==r.code||"year"===e)));let u="";return u="big"===gn[n]?l().createElement("div",{className:"FormDate__inputs"},this.renderYear(i,d,o),this.renderMonth(s,d),this.renderDay(a,d)):"little"===gn[n]?l().createElement("div",{className:"FormDate__inputs"},this.renderDay(a,d,o),this.renderMonth(s,d),this.renderYear(i,d)):l().createElement("div",{className:"FormDate__inputs"},this.renderMonth(s,d,o),this.renderDay(a,d),this.renderYear(i,d)),l().createElement("div",{className:"FormDate"},l().createElement("label",{className:`FormDate__label ${e}-label`,htmlFor:"month-field"},t),u,!c&&r.message&&l().createElement(l().Fragment,null,l().createElement(en,{errorMessage:r.message})))}}hn.defaultProps={value:{},dateEndianness:"MIDDLE_ENDIAN",minAge:13};const mn=(0,p.$j)((()=>({})),(()=>({})))(hn),fn=["name","label","options","value","showTitle","error","onValidate","onOptionFocus"];class bn extends l().PureComponent{constructor(e){super(e),this.state={isEditing:!1},this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this)}handleBlur(e){this.state={isEditing:!1};(e.relatedTarget?e.relatedTarget.name:null)!==this.props.name&&this.validate(e.target)}handleFocus(e){this.state={isEditing:!0},this.props.onOptionFocus&&e&&e.target&&this.props.onOptionFocus(e.target.value)}validate(e){const{name:t,onValidate:n}=this.props;n&&n(t,Jt(e))}render(){const e=this.props,{name:t,label:n,options:r,value:o,showTitle:a,error:s={},onValidate:i,onOptionFocus:c}=e,d=Oe()(e,fn),{isEditing:u}=this.state,p=`${t}-field`,g=Xt()("FormRadioSelect",{"FormRadioSelect--is-disabled":this.props.disabled});return l().createElement("div",{className:g},l().createElement("label",{className:a?"":"glue-hidden-visually",htmlFor:p},n),r.map((e=>{const n=`${e.value}-radio`;return l().createElement("span",{className:o===e.value?"checked":"",key:e.value},l().createElement("input",sn()({},d,{name:t,type:"radio",id:n,className:"glue-hidden-visually",value:e.value,checked:o===e.value,onBlur:this.handleBlur,onFocus:this.handleFocus,required:!0,disabled:this.props.disabled})),l().createElement("label",{className:Xt()("FormRadioSelect__label",{"FormRadioSelect__label--has-error":!!s.message}),htmlFor:n},e.label))})),!u&&s.message&&l().createElement(l().Fragment,null,l().createElement(en,{errorMessage:s.message})))}}const En=(0,p.$j)((()=>({})),(()=>({})))(bn);class yn extends l().PureComponent{constructor(...e){super(...e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.isDisabled||this.props.onChange(e.target.checked)}render(){const e=`${this.props.name}-field`,t=Xt()("GlueCheckbox",{"GlueCheckbox--is-disabled":this.props.isDisabled});return l().createElement("div",{className:t},l().createElement("input",{className:"GlueCheckbox__input",id:e,name:this.props.name,checked:this.props.isChecked,type:"checkbox",onChange:this.handleChange,disabled:this.props.isDisabled}),l().createElement("label",{className:"GlueCheckbox__label",htmlFor:e,dangerouslySetInnerHTML:{__html:this.props.label}}))}}yn.defaultProps={label:"",name:"",isChecked:!1,isDisabled:!1,onChange(){}};var _n=n(9717);class Sn extends l().Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this)}handleClick(e){if(e.target.getAttribute("data-action")){const t=e.target.getAttribute("data-action");"showSettings"===t?this.props.openSettingsPage():"showSignup"===t&&this.props.openSignupPage()}}render(){const e=this.props.errorData,t=e?Zt(e.errorCategory,e.errorCode,e.errorReference):null;return t?l().createElement("div",{className:"alert alert-danger ErrorMessage alert-icon",id:"login-message","data-ta-id":"login-message",role:"alert","aria-live":"assertive",onClick:this.handleClick},l().createElement(_n.w,{iconSize:24}),l().createElement("span",{dangerouslySetInnerHTML:{__html:t}})):null}}const wn=(0,p.$j)((e=>{let{mode:t}=e.app;return"welcome"===t&&(t="signup"),{errorData:e[t]&&e[t].errorData?e[t].errorData:null}}),(e=>({openSettingsPage:()=>e(jt.enterSettingsMode()),openSignupPage:()=>e(jt.openSignupPage())})))(Sn);class kn extends l().PureComponent{static getNextId(){const e=(kn.instanceCount||0)+1;return kn.instanceCount=e,e}constructor(e){super(e),this.state={tosAgreed:!1,privacyAgreed:!1},this.handleTosChange=this.handleTosChange.bind(this),this.handlePrivacyChange=this.handlePrivacyChange.bind(this),this.handleTosAndPrivacyChange=this.handleTosAndPrivacyChange.bind(this),this.handleEulaChange=this.handleEulaChange.bind(this),this.eulaId=kn.getNextId()}handleTosChange(e){this.setState({tosAgreed:e},(()=>{this.handleEulaChange()}))}handlePrivacyChange(e){this.setState({privacyAgreed:e},(()=>{this.handleEulaChange()}))}handleTosAndPrivacyChange(e){this.setState({tosAgreed:e,privacyAgreed:e},(()=>{this.handleEulaChange()}))}handleEulaChange(){this.props.onChange(this.state.tosAgreed&&this.state.privacyAgreed)}render(){let e=null;const t=`<a href="https://www.spotify.com/int/legal/end-user-agreement/" target="_new">${St.get("desktop.login.TermsAndConditions")}</a>`,n=`<a href="https://www.spotify.com/int/legal/privacy-policy/" target="_new">${St.get("desktop.login.PrivacyPolicy")}</a>`,r=St.get("desktop.login.SignupButton");return e=this.props.restrictions.pretick_eula?l().createElement("div",null,!this.props.hideTermsAndConditions&&l().createElement("p",{className:"SignupForm__terms-and-conditions",dangerouslySetInnerHTML:{__html:St.get("desktop.login.SignupAgree",r,t)}}),!this.props.hidePrivacyPolicy&&l().createElement("p",{className:"SignupForm__privacy-policy",dangerouslySetInnerHTML:{__html:St.get("desktop.login.PrivacyPolicyAgree",n)}})):this.props.restrictions.can_accept_licenses_in_one_step?l().createElement("div",{className:"SignupForm__checkbox-container"},l().createElement(yn,{"data-ta-id":"agree-eula",name:`agree-eula-${this.eulaId}`,label:this.props.restrictions.specific_licenses?St.get("desktop.login.SignupAgreeCheckboxSpecificLicenses",t,n):St.get("desktop.login.SignupAgreeCheckbox",t,n),onChange:this.handleTosAndPrivacyChange,isChecked:this.state.tosAgreed&&this.state.privacyAgreed,isDisabled:this.props.disabled}),this.props.restrictions.specific_licenses&&l().createElement("p",{className:"SignupForm__privacy-policy",dangerouslySetInnerHTML:{__html:St.get("desktop.login.PrivacyPolicyAgree",n)}})):l().createElement("div",null,l().createElement("div",{className:"SignupForm__checkbox-container"},l().createElement(yn,{"data-ta-id":"agree-tos",name:`agree-tos-${this.eulaId}`,label:St.get("desktop.login.TermsOfServiceAgreeCheckbox",t),onChange:this.handleTosChange,isChecked:this.state.tosAgreed,isDisabled:this.props.disabled})),l().createElement("div",{className:"SignupForm__checkbox-container"},l().createElement(yn,{"data-ta-id":"agree-privacy",name:`agree-privacy-${this.eulaId}`,label:St.get("desktop.login.PrivacyPolicyAgreeCheckbox",n),onChange:this.handlePrivacyChange,isChecked:this.state.privacyAgreed,isDisabled:this.props.disabled}))),l().createElement("div",{className:"EulaAgreement"},e,this.props.error&&l().createElement(l().Fragment,null,l().createElement(en,{errorMessage:this.props.error.message})))}}const vn=(0,p.$j)((()=>({})),(()=>({})))(kn);class On extends l().PureComponent{constructor(...e){super(...e),f()(this,"handleClick",(e=>{const{method:t}=this.props;e&&(e.preventDefault(),e.stopPropagation()),this.props.onClick(t)}))}render(){const{type:e,label:t,isDisabled:n,method:r}=this.props,o=r.substr(0,1).toUpperCase()+r.substr(1),a=Xt()("button","SocialButton",`${o}Button`,{[`${o}Button--login`]:"login"===e,[`${o}Button--signup`]:"signup"===e});return l().createElement("button",{type:"button",className:a,onClick:this.handleClick,"data-ta-id":`${r}-${e}-button`,disabled:n},t)}}function Pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pn(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class Tn extends l().PureComponent{constructor(e){super(e),f()(this,"handleAgreeEulaChange",(e=>{const t=e?"checked":"unchecked";this.props.onInteraction("signup","click",`eula-change-${t}`),this.setState({eulaAgreed:e,error:e?{}:this.state.error})})),f()(this,"handleOnClick",((...e)=>{(()=>this.state.eulaAgreed||this.props.restrictions.pretick_eula||this.props.hideEula)()?this.props.onClick(...e):this.setState({error:{message:St.get("desktop.login.agreeEula.notAccepted")}})})),this.state={eulaAgreed:this.props.restrictions.pretick_eula,error:{}}}render(){return l().createElement("div",{className:"SignupFacebook"},l().createElement(On,{method:"facebook",isDisabled:this.props.isDisabled,onClick:this.handleOnClick,type:"signup",label:St.get("desktop.login.SignupButtonFacebookNirvana")}),this.props.restrictions.pretick_eula||this.props.hideEula?null:l().createElement(vn,{restrictions:this.props.restrictions,error:this.state.error,disabled:this.props.isDisabled,onChange:this.handleAgreeEulaChange}))}}f()(Tn,"defaultProps",{isDisabled:!1,hideEula:!1});const In=(0,p.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions})),(e=>({onInteraction:(t,n,r,o,a)=>e(jt.interaction(t,n,r,o,a)),onClick:t=>{const n=Vt();e(jt.signupWithAccounts(t,n)),e(jt.interaction("signup","click",`create-account-${t}`,null,n))}})),((e,t)=>Cn(Cn(Cn({},e),t),{},{onClick:e=>{t.onClick(e)}})))(Tn),Nn=({title:e})=>l().createElement("p",{className:"FormTitleSeparator","aria-hidden":"true"},e);Nn.defaultProps={title:""};const Dn=Nn;class An extends l().PureComponent{constructor(e){super(e),f()(this,"handleEmailValidate",((e,t)=>{this.props.onValidate(e,t),t||this.props.validateEmail()})),f()(this,"handleEmailFocus",(()=>{this.props.onInteraction("signup","click","input-email")})),f()(this,"handlePasswordValidate",((e,t)=>{this.props.onValidate(e,t),t||this.props.validatePassword()})),f()(this,"handlePasswordFocus",(()=>{this.props.onInteraction("signup","click","input-password")})),f()(this,"handleNameFocus",(()=>{this.props.onInteraction("signup","click","input-name")})),f()(this,"handleGenderOptionFocus",(e=>{this.props.onInteraction("signup","click",`input-gender-${e}`)})),f()(this,"handleInputChange",(({target:{name:e,value:t}})=>{this.props.updateData({[e]:t}),this.setState({isEditing:!0})})),f()(this,"handleBirthDateChange",(e=>{this.props.updateData({birthDate:e})})),f()(this,"handleSendEmailChange",(e=>{this.props.updateData({sendEmail:e})})),f()(this,"handleShareDataChange",(e=>{this.props.updateData({shareData:e})})),f()(this,"handleAgreeEulaChange",(e=>{this.props.updateData({agreeEula:e})})),f()(this,"handleSubmit",(e=>{e&&e.preventDefault();const{step:t}=this.props,n=Vt();this.props.onInteraction("signup","click",0===t?"continue":"create-account",null,n),this.setState({isEditing:!1});let r=!0;const o={0:["email","password","name"],1:["birthDate","gender","agreeEula"]};!!this.props.errors&&Object.keys(this.props.errors).filter((e=>-1!==o[t].indexOf(e))).some((e=>this.props.errors[e]&&this.props.errors[e].message))&&(r=!1);const a=e=>t=>{this.props.data[t]||(this.props.onValidate(t,{code:e}),r=!1)};switch(t){case 0:["email","password","name"].forEach(a("valueMissing"));break;case 1:{const{day:e,month:t,year:o}=this.props.data.birthDate;o||this.props.onInteraction("signup","view","show-error-empty-year",null,n),t||this.props.onInteraction("signup","view","show-error-empty-month",null,n),e||this.props.onInteraction("signup","view","show-error-empty-date",null,n);const s=dn(e,t,o,this.props.restrictions.minimum_age);s&&(this.props.onValidate("birthDate",{code:s}),r=!1),a("valueMissing")("gender"),a("notAccepted")("agreeEula")}}if(r)switch(t){case 0:this.setStep(t+1);break;case 1:this.props.signup(n)}})),f()(this,"handleBack",(()=>{const{step:e}=this.props;this.props.onInteraction("signup","click",`back-step-${e+1}`),this.props.clearAllErrors(),e<=0?this.props.enterWelcomeMode():this.setStep(e-1)})),f()(this,"handleLogin",(()=>{const e=Vt();this.props.onInteraction("signup","click","open-page-login",null,e),this.props.enterLoginMode(e)})),f()(this,"setStep",(e=>{switch(e){case 0:this.props.enterSignupModeStep0();break;case 1:this.props.enterSignupModeStep1()}})),this.state={isEditing:!0}}renderErrorMsg(){const e=Object.keys(this.props.errors).filter((e=>this.props.errors[e]&&this.props.errors[e].message));return l().createElement("div",{className:"glue-hidden-visually",role:"alert","aria-live":this.state.isEditing?"off":"assertive"},e.length>0?l().createElement("div",null,l().createElement("p",null,St.get("desktop.login.email.errorMessageA11y",e.length)),l().createElement("ul",null,e.map((e=>l().createElement("li",{key:e},this.props.errors[e].message))))):null)}renderStep0(){const{data:e,errors:t,isDisabled:n,onValidate:r}=this.props;return l().createElement("div",null,l().createElement(on,{name:"email",type:"email",label:St.get("desktop.login.SignupEmail"),value:e.email,onChange:this.handleInputChange,isDisabled:n,error:t.email,onValidate:this.handleEmailValidate,onFocus:this.handleEmailFocus,isRequired:!0,autoFocus:!0,rightIcon:Kt.w}),l().createElement(on,{name:"password",type:"password",label:St.get("desktop.login.CreateAPassword"),value:e.password,onChange:this.handleInputChange,minLength:8,isRequired:!0,isDisabled:n,error:t.password,onValidate:this.handlePasswordValidate,onFocus:this.handlePasswordFocus,onTogglePasswordVisibility:e=>{this.props.onInteraction("signup","click",e?"toggle-password-visibility-show":"toggle-password-visibility-hide")}}),l().createElement(on,{name:"name",label:St.get("desktop.login.SignupName"),value:e.name,onChange:this.handleInputChange,isRequired:!0,isDisabled:n,error:t.name,onValidate:r,rightIcon:qt.K,onFocus:this.handleNameFocus}))}renderStep1(){const{data:e,errors:t,restrictions:n,isDisabled:r,onValidate:o}=this.props;let a=null;n.requires_marketing_opt_in_text?a=l().createElement("div",{className:"SignupForm__send-email-implicit"},St.get("desktop.login.SendEmailImplicitLabel")):n.requires_marketing_opt_in&&(a=l().createElement("div",{className:"SignupForm__checkbox-container"},l().createElement(yn,{name:"send-email",label:St.get("desktop.login.SendEmailLabel"),onChange:this.handleSendEmailChange,isChecked:e.sendEmail,isDisabled:r})));const s=[{label:St.get("desktop.login.Female"),value:"female"},{label:St.get("desktop.login.Male"),value:"male"}];return n.use_all_genders&&s.push({label:St.get("desktop.login.NonBinary"),value:"neutral"}),l().createElement("div",null,l().createElement(mn,{name:"birth-date",label:St.get("desktop.login.WhatsYourSignupBirthDate"),value:e.birthDate,onChange:this.handleBirthDateChange,disabled:r,error:t.birthDate,onValidate:o,dateEndianness:n.date_endianness,minAge:n.minimum_age,autoFocus:!0,onFocus:()=>{this.props.onInteraction("signup","click","input-birth-date")}}),l().createElement(En,{showTitle:!0,name:"gender",label:St.get("desktop.login.WhatsYourSignupGender"),options:s,value:e.gender,onChange:this.handleInputChange,disabled:r,error:t.gender,onValidate:o,onOptionFocus:this.handleGenderOptionFocus}),a,l().createElement(vn,{restrictions:n,error:t.agreeEula,disabled:r,onChange:this.handleAgreeEulaChange}))}render(){const{isDisabled:e,step:t}=this.props;return l().createElement("form",{onSubmit:this.handleSubmit,className:"SignupForm"},this.renderErrorMsg(),l().createElement(wn,null),0===t?this.renderStep0():"",1===t?this.renderStep1():"",l().createElement("button",{type:"submit",className:"button button-green button-large SignupForm__signup-button",disabled:e,id:"signup-button",onClick:this.handleSubmit,"data-ta-id":"signup-submit"},0===t?St.get("desktop.login.Continue"):St.get("desktop.login.SignupButton")),0===t&&l().createElement(l().Fragment,null,l().createElement(Dn,{title:St.get("desktop.login.SignupOr")}),l().createElement(In,null)),l().createElement("a",{href:"#",className:"SignupForm__back-button",onClick:this.handleBack},St.get("desktop.login.Back")),0===t&&l().createElement("h3",{className:"FooterFormText"},l().createElement("a",{className:"FooterFormText__NoUnderline",href:"#",id:"login-link",onClick:this.handleLogin,dangerouslySetInnerHTML:{__html:St.get("desktop.login.AlreadyOnSpotifyLogin")}})))}}f()(An,"defaultProps",{errors:{},data:{},step:0});const Fn=(0,p.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions,email:e.signup.email,errors:e.signup.errors,data:e.signup.formData})),(e=>({signup:t=>e(jt.signup(t)),enterLoginMode:()=>e(jt.enterLoginMode()),enterSignupModeStep0:()=>e(jt.enterSignupModeStep0()),enterSignupModeStep1:()=>e(jt.enterSignupModeStep1()),updateData:t=>e(jt.updateSignupData(t)),validateEmail:()=>e(jt.validateField("email")),validatePassword:()=>e(jt.validateField("password")),enterWelcomeMode:()=>e(jt.enterWelcomeMode()),clearAllErrors:()=>e(jt.clearAllErrors()),onValidate:(t,n)=>{if(n){const r=n.code||n,o={birthDate:{incomplete:St.get("desktop.login.birthDate.incomplete"),invalid:St.get("desktop.login.birthDate.invalid")},password:{valueMissing:St.get("desktop.login.password.valueMissing"),tooShort:St.get("desktop.login.password.tooShort")},email:{valueMissing:St.get("desktop.login.email.valueMissing"),typeMismatch:St.get("desktop.login.email.typeMismatch")},name:{valueMissing:St.get("desktop.login.name.valueMissing")},gender:{valueMissing:St.get("desktop.login.gender.valueMissing")},agreeEula:{notAccepted:St.get("desktop.login.agreeEula.notAccepted")}};e(jt.validateFieldFailure(t,{code:r,message:o[t]&&o[t][r]||""}))}else e(jt.validateFieldSuccess(t))},onInteraction:(t,n,r,o,a)=>e(jt.interaction(t,n,r,o,a))})))(An);class Mn extends l().PureComponent{render(){const{step:e,restrictions:t}=this.props;if(!t)return l().createElement(Gt,{delay:2e3});const n=0===e?St.get("desktop.login.SignupHeroText"):St.get("desktop.login.SignupAlmostDone");return l().createElement("main",{className:"Signup","aria-labelledby":"signup-form-title",id:"signup","data-ta-id":"signup-form"},l().createElement("h1",{className:"HeroText",id:"signup-form-title"},n),l().createElement(Fn,{step:e}))}}const Ln=(0,p.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions})))(Mn);class Rn extends l().PureComponent{constructor(...e){super(...e),this.handleChange=this.handleChange.bind(this)}handleChange(){this.props.isDisabled||this.props.onChange(!this.props.isActive)}render(){const{isActive:e,isDisabled:t,labelId:n,taId:r}=this.props;return l().createElement("div",{className:Xt()("GlueToggle",{"GlueToggle--is-active":e,"GlueToggle--is-disabled":t})},l().createElement("input",{type:"checkbox",name:n,id:n,className:"glue-hidden-visually",onChange:this.handleChange,checked:e,disabled:t,"data-ta-id":r}),l().createElement("div",{className:"GlueToggle__toggle",onClick:this.handleChange,"aria-hidden":"true"},l().createElement("div",{className:"GlueToggle__toggle-inner"})))}}Rn.defaultProps={isActive:!1,isDisabled:!1,onChange:()=>{}};class xn extends l().PureComponent{render(){const{name:e,label:t,checked:n,disabled:r,onChange:o}=this.props,a=`${e}-field`;return l().createElement("div",{className:"FormToggle"},l().createElement("label",{htmlFor:a,"data-ta-id":"remember-me-label"},t),l().createElement(Rn,{labelId:a,isActive:n,onChange:o,taId:"remember-me-slider",isDisabled:r}))}}class Un extends l().PureComponent{constructor(e){super(e),f()(this,"handleForgotPasswordLinkClick",(()=>{this.props.onInteraction("login","click","reset-password")})),this.state={username:this.props.username,password:"",rememberMe:!0},["handleSubmit","handleUsernameChange","handleUsernameFocus","handlePasswordChange","handlePasswordFocus","handleRememberMeChange"].forEach((e=>{this[e]=this[e].bind(this)}))}handleUsernameChange({target:e}){this.setState({username:e.value})}handleUsernameFocus(){this.props.onInteraction("login","click","input-email")}handlePasswordChange({target:e}){this.setState({password:e.value})}handlePasswordFocus(){this.props.onInteraction("login","click","input-password")}handleRememberMeChange(){this.setState({rememberMe:!this.state.rememberMe})}handleSubmit(e){e&&e.preventDefault();const t=this.state.username.trim(),{password:n,rememberMe:r}=this.state,o=Vt();this.props.onInteraction("login","click","login-email",null,o),t&&n?this.props.login({username:t,password:n,rememberMe:r},!1,o):t?n||this.props.onInteraction("login","view","show-error-empty-password",null,o):this.props.onInteraction("login","view","show-error-empty-email",null,o)}render(){const{isDisabled:e}=this.props;return l().createElement("form",{onSubmit:this.handleSubmit},l().createElement("h3",{className:"glue-hidden-visually"},St.get("desktop.login.LoginWithEmailTitle")),l().createElement(wn,null),l().createElement(on,{name:"username",label:St.get("desktop.login.LoginUsernameOrEmail"),value:this.state.username||"",onChange:this.handleUsernameChange,onFocus:this.handleUsernameFocus,isDisabled:e,autoFocus:!0,noValidate:!0,rightIcon:Kt.w}),l().createElement(on,{name:"password",type:"password",label:St.get("desktop.login.LoginPassword"),value:this.state.password,onChange:this.handlePasswordChange,onFocus:this.handlePasswordFocus,isDisabled:e,noValidate:!0}),l().createElement("a",{className:"LoginForm__reset-password",href:"https://www.spotify.com/redirect/password-reset",target:"_new",onClick:this.handleForgotPasswordLinkClick},St.get("desktop.login.forgotPassLink")),l().createElement(xn,{name:"remember-me",label:St.get("desktop.login.RememberMeLabel"),checked:this.state.rememberMe,onChange:this.handleRememberMeChange,disabled:e}),l().createElement("button",{type:"submit",className:"button button-white LoginForm__login-button",disabled:e,id:"login-button","data-ta-id":"login-button"},St.get("desktop.login.LoginButton")))}}const jn=(0,p.$j)((e=>({isDisabled:!!e.login.loginInProgress,username:e.login.username})),(e=>({login:(t,n,r)=>e(jt.login(t,n,r)),onInteraction:(t,n,r,o,a)=>e(jt.interaction(t,n,r,o,a))})))(Un);function Gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gn(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class $n extends l().PureComponent{componentWillUnmount(){this.props.clearErrors()}handleSignup(){const e=Vt();this.props.enterSignupMode(e),this.props.onInteraction("login","click","open-page-signup",null,e)}getSignupLink(){return l().createElement("a",{className:"FooterFormText__NoUnderline",href:"#",id:"signup-link",onClick:()=>this.handleSignup(),"data-ta-id":"signup-link",dangerouslySetInnerHTML:{__html:St.get("desktop.login.DontHaveAnAccountSignup")}})}render(){const{isDisabled:e}=this.props;return l().createElement("main",{className:"Login","aria-labelledby":"login-form-title",id:"login","data-ta-id":"login-form"},l().createElement("h1",{className:"HeroText",id:"login-form-title"},St.get("desktop.login.LoginHeroText")),l().createElement(jn,null),l().createElement(Dn,{title:St.get("desktop.login.SignupOr")}),l().createElement(On,{method:"facebook",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:St.get("desktop.login.ContinueWithFacebook")}),l().createElement(On,{method:"google",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:St.get("desktop.login.ContinueWithGoogle")}),l().createElement(On,{method:"apple",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:St.get("desktop.login.ContinueWithApple")}),l().createElement("h3",{className:"FooterFormText"},this.getSignupLink()))}}const Vn=(0,p.$j)((e=>({isDisabled:!!e.login.loginInProgress})),(e=>({enterSignupMode:t=>e(jt.enterSignupMode(t)),onInteraction:(t,n,r,o,a)=>e(jt.interaction(t,n,r,o,a)),onSocialButtonClick:t=>{const n=Vt();e(jt.loginWithAccounts(t,n)),e(jt.interaction("login","click",`login-${t}`,null,n))},clearErrors:()=>e(jt.loginClearErrors())})),((e,t)=>Bn(Bn(Bn({},e),t),{},{onSocialButtonClick:e=>{t.onSocialButtonClick(e)}})))($n);class Wn extends l().PureComponent{render(){const{operationUsed:e}=this.props,t="signup"===e?St.get("desktop-auth.login.redirecting-to-browser-signup"):St.get("desktop-auth.login.redirecting-to-browser-login");return l().createElement("main",null,l().createElement("h1",{className:"HeroText __redirect"},t))}}const Hn=(0,p.$j)((e=>({operationUsed:e.experimentWebAuthReducer.operationUsed})))(Wn);var Yn=n(7945);const Kn={button:"Qt5xfSWikz6CLU8Vobxs","button-primary":"pWY0RsrzxnQm9yHtovC8","button-secondary":"jzic9t5dn38QUOYlDka0","button-outlined":"X7lQWw2Ly_RZVPEFj2QY","button-tertiary":"NKswMkKwGl8FphQQVSEb","btn-block":"Ki84cEjfUZwLueXLtLO2"},qn=e=>l().createElement("button",{id:e.id,className:Xt()(Kn.button,Kn[`button-${e.version}`],e.className,{[Kn["btn-block"]]:e.block}),type:"button",onClick:e.onClick,disabled:e.disabled,"aria-label":e.ariaLabel,"aria-hidden":e.standalone,"data-testid":e.testID,title:e.title},e.children);qn.defaultProps={onClick:()=>{}};const zn=e=>{const t={className:Xt()(Kn.button,Kn[`button-${e.version}`],e.className,{[Kn["btn-block"]]:e.block}),title:e.title,draggable:e.draggable||!1,onClick:e.onClick,"data-testid":e.testID};return e.href?l().createElement("a",sn()({},t,{target:e._blank?"_blank":"_self",href:e.href}),e.children):e.linkTo?l().createElement(Yn.rU,sn()({},t,{to:e.linkTo}),e.children):l().createElement(qn,e,e.children)};qn.defaultProps={onClick:()=>{}};const Xn="zrvvPyoxE6wQNqnu0yWA",Zn=({value:e,id:t,children:n,disabled:r,onSelect:o,className:a,dir:s})=>l().createElement("span",{className:a},l().createElement("select",{className:Xn,value:null==e?void 0:e.toString(),id:t,disabled:r,onBlur:()=>{},onChange:e=>{o(e.target.value)},dir:s},n)),Jn={horizontalPair:"TIU9DuYaVxHVHSUb050e",ProxySettings:"HAqO2XB1kc4cGIDulu92",fullWidth:"ykqMpIHvpnF6XjtvEnAB",proxyInput:"Ex5qZvK9ck_COzwudreW",labelStretch:"LRqmVJV9oEKbTo6IyIjh",restartAppButton:"UwXx1VsrVwaSHruCIAi3",title:"X69rF0dyTnC9Dr4E1N8J"};var Qn=n(1124);const er=({id:e,type:t,placeHolder:n,inputRef:r,handleOnChange:o})=>l().createElement("input",{type:t||"text",id:e,"data-testid":e,className:Jn.proxyInput,placeholder:n,ref:r,onChange:o}),tr=({children:e,label:t})=>l().createElement(Qn.cw,{label:t},e),nr={isBook:"q8JtWrg1WCUrFY2MzOBq",isBold:"PKVTHA5io1M8d45i8zTV",isBlack:"DWwTfiq5mV0rxLXge_LQ",isCondensed:"vXyG7FBt6UnUpSuQ94KF",bass:"Afp2Urf1F4Ub6nHGSF9i",forte:"iXZwF9JkkOC9IgDBajxr",brio:"fobxZOE9C5TZqLIxWcfk",alto:"jDhY6c7obZ6QMTKlZM_w",canon:"wAEzJUGDXfAUyDe6nzIW",cello:"xP6C4l_KlGJB3UxIOfuS",ballad:"w_Xs9cRXMwmQHw8BpiID",balladBold:"JSkXrK3CXFYeDgTW8iHv",mesto:"Hi9FqPX1LNRRPf31tfA8",mestoBold:"Czg_RoYmXG0FPTHG9Kdb",metronome:"RhEgafyO2x0bdAfxpfWg",finale:"SYnLm8pwZls9sOX9AvJZ",finaleBold:"QanBr97fzoAzu_w84Vlk",minuet:"w5r2OGxHEeky6qGeckXf",minuetBold:"gvMYy0vqOxuYtbOkc6sH",viola:"hiafLxik6ZwVSfnqHxkV",violaBold:"g2bPkRAC0wiu9xTnwWsr"};var rr=n(3012);const or=["color","variant","condensed","weight","className"];function ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let ir,lr;!function(e){e.bass="bass",e.forte="forte",e.brio="brio",e.alto="alto",e.canon="canon",e.cello="cello",e.ballad="ballad",e.balladBold="balladBold",e.viola="viola",e.violaBold="violaBold",e.mesto="mesto",e.mestoBold="mestoBold",e.metronome="metronome",e.minuet="minuet",e.minuetBold="minuetBold",e.finale="finale",e.finaleBold="finaleBold"}(ir||(ir={})),function(e){e.book="book",e.bold="bold",e.black="black"}(lr||(lr={}));const cr=l().forwardRef(((e,t)=>{let{color:n,variant:r=ir.ballad,condensed:o,weight:a,className:s}=e,i=Oe()(e,or);const c=(e=>void 0!==e&&Object.prototype.hasOwnProperty.call(rr.$_Y,e))(n)?rr.$_Y[n]:n,d=nr[r],u=i.as?i.as:"span";return l().createElement(u,sn()({className:Xt()(s,{[d]:!!d,[nr.isBook]:a===lr.book,[nr.isBold]:a===lr.bold,[nr.isBlack]:a===lr.black,[nr.isCondensed]:o}),style:{color:c||""},ref:t},i))})),dr=sr(sr(sr({},{h1:l().forwardRef(((e,t)=>l().createElement(cr,sn()({as:"h1",ref:t},e)))),h2:l().forwardRef(((e,t)=>l().createElement(cr,sn()({as:"h2",ref:t},e)))),h3:l().forwardRef(((e,t)=>l().createElement(cr,sn()({as:"h3",ref:t},e)))),h4:l().forwardRef(((e,t)=>l().createElement(cr,sn()({as:"h4",ref:t},e)))),h5:l().forwardRef(((e,t)=>l().createElement(cr,sn()({as:"h5",ref:t},e)))),h6:l().forwardRef(((e,t)=>l().createElement(cr,sn()({as:"h6",ref:t},e)))),p:l().forwardRef(((e,t)=>l().createElement(cr,sn()({as:"p",ref:t},e)))),small:l().forwardRef(((e,t)=>l().createElement(cr,sn()({as:"small",ref:t},e)))),li:l().forwardRef(((e,t)=>l().createElement(cr,sn()({as:"li",ref:t},e)))),span:l().forwardRef(((e,t)=>l().createElement(cr,sn()({as:"span",ref:t},e))))}),ir),lr),ur=Object.assign(cr,dr),pr=(e,t,n)=>{let r=`${e}:${t}`;switch(n){case wt:r+="@http";break;case kt:r+="@socks4";break;case vt:r+="@socks5"}return r},gr=({addr:e,mode:t,pass:n,user:r,setValue:o,restartContainer:a,fullWidth:s})=>{const c=(0,i.useRef)(null),d=(0,i.useRef)(null),u=(0,i.useRef)(null),p=(0,i.useRef)(null),[g,h]=(0,i.useState)(""),[m,f]=(0,i.useState)(""),[b,E]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const[t,n]=(null==e?void 0:e.split(/[:@]+/))||["",""];h(t),f(n),c.current&&(c.current.value=t),d.current&&(d.current.value=n)}),[e]),(0,i.useEffect)((()=>{p.current&&n&&(p.current.value=n.toString())}),[n]),(0,i.useEffect)((()=>{u.current&&r&&(u.current.value=r.toString())}),[r]);const y=(0,i.useCallback)((({target:e})=>{const n=pr(e.value,m,t||0);h(e.value),o("network.proxy.addr",n),E(!0)}),[t,m,o]),_=(0,i.useCallback)((({target:e})=>{const n=pr(g,e.value,t||0);f(e.value),o("network.proxy.addr",n),E(!0)}),[t,g,o]),S=(0,i.useCallback)((({target:e})=>{o("network.proxy.user",e.value),E(!0)}),[o]),w=(0,i.useCallback)((({target:e})=>{o("network.proxy.pass",e.value),E(!0)}),[o]),k=0!==t&&1!==t,v=t!==kt;return l().createElement("div",{className:[Jn.ProxySettings,s?Jn.fullWidth:""].join(" ")},l().createElement(ur,{as:"h2",variant:ur.cello,className:Jn.title},St.get("desktop.settings.proxy.title")),l().createElement(tr,{label:St.get("desktop.settings.proxy.type")},l().createElement(Zn,{className:Jn.secondColumn,id:"network.proxy.mode",value:t,onSelect:e=>{const t=parseInt(e,10);o("network.proxy.mode",t),E(!0)}},Pt.map((({enumKey:e,enumValue:t})=>l().createElement("option",{key:e,value:t,"data-testid":e},Ot[e]?Ot[e].label():""))))),k?l().createElement(l().Fragment,null,l().createElement("div",{className:Jn.horizontalPair},l().createElement(tr,{label:St.get("desktop.settings.proxy.host")},l().createElement(er,{id:"network.proxy.host",handleOnChange:y,placeHolder:St.get("desktop.settings.proxy.host"),inputRef:c})),l().createElement(tr,{label:St.get("desktop.settings.proxy.port")},l().createElement(er,{id:"network.proxy.port",type:"number",handleOnChange:_,placeHolder:St.get("desktop.settings.proxy.port"),inputRef:d}))),l().createElement("div",{className:v?Jn.horizontalPair:void 0},l().createElement(tr,{label:St.get("desktop.settings.proxy.user")},l().createElement(er,{id:"network.proxy.user",handleOnChange:S,placeHolder:St.get("desktop.settings.proxy.user"),inputRef:u})),v?l().createElement(tr,{label:St.get("desktop.settings.proxy.pass")},l().createElement(er,{id:"network.proxy.pass",handleOnChange:w,placeHolder:St.get("desktop.settings.proxy.pass"),type:"password",inputRef:p})):null)):null,b&&l().createElement(zn,{className:Jn.restartAppButton,version:"outlined",onClick:a},St.get("settings.restartApp")))};function hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const mr=["network.proxy.mode","network.proxy.addr","network.proxy.user","network.proxy.pass"];const fr=(0,p.$j)((e=>({settings:{proxy:e.settings.proxy}})),(e=>({fetchProxySettings(){e(jt.fetchProxySettings())},updateProxySettings(t){e(jt.updateProxySettings(t))},restartClient(){e(jt.restartClient())}})))((({settings:e={proxy:{mode:0,address:"",username:"",password:""}},fetchProxySettings:t=(()=>{}),updateProxySettings:n=(()=>{}),restartClient:r=(()=>{})})=>{(0,i.useEffect)((()=>{t()}),[t]);const o=(0,i.useCallback)(((t,r)=>{if(function(e){return!!mr.includes(e)}(t)){const o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.proxy);switch(t){case"network.proxy.mode":o.mode=r;break;case"network.proxy.addr":o.address=r;break;case"network.proxy.user":o.username=r;break;case"network.proxy.pass":o.password=r}n(o)}return Promise.resolve()}),[e,n]);return l().createElement("main",{className:"Settings","aria-labelledby":"settings-form-title"},l().createElement("h1",{className:"HeroText",id:"settings-form-title"},St.get("desktop.login.PreferencesLink")),l().createElement(gr,{mode:e.proxy.mode,addr:e.proxy.address,user:e.proxy.username,pass:e.proxy.password,setValue:o,restartContainer:r,fullWidth:!0}))}));class br extends l().PureComponent{constructor(e){super(e),this.handleSettingsClick=this.goToSettingsPage.bind(this),this.handleBackToLoginClick=this.handleBackToLoginClick.bind(this)}handleSignupClick(){const{openSignupPage:e,onInteraction:t}=this.props,n=Vt();e(n),t("login/welcome","click","open-page-signup",null,n)}handleBackToLoginClick(e){e.preventDefault(),this.props.openLoginPage(),this.props.onInteraction(this.props.mode,"click","back-to-login")}goToSettingsPage(e){e.preventDefault(),this.props.openSettingsPage(),this.props.onInteraction(this.props.mode,"click","open-page-settings")}renderPreferencesLink(){return l().createElement("a",{className:"Footer__link",href:"#",onClick:this.handleSettingsClick,"data-ta-id":"login-footer-settings"},St.get("desktop.login.PreferencesLink"))}renderBackToLoginLink(){return l().createElement("a",{className:"Footer__link",href:"#",onClick:this.handleBackToLoginClick,"data-ta-id":"login-footer-settings-back-to-login"},St.get("desktop.login.Back"))}renderTryAgain(){return l().createElement(l().Fragment,null,l().createElement("span",null,St.get("desktop-auth.login.not-seeing-browser"))," ",l().createElement("a",{href:"#",onClick:()=>this.props.tryAgainHandler()},St.get("desktop-auth.login.try-again")))}renderSignupLink(){return l().createElement("a",{className:"Footer__NoUnderline",href:"#",id:"signup-link",onClick:()=>this.handleSignupClick(),"data-ta-id":"welcome-signup-link",dangerouslySetInnerHTML:{__html:St.get("desktop.login.DontHaveAnAccountSignup")}})}render(){const{mode:e}=this.props;return l().createElement("footer",{className:"Footer",role:"contentinfo"},"login"===e&&this.renderPreferencesLink(),"settings"===e&&this.renderBackToLoginLink(),"open-browser"===e&&this.renderTryAgain(),"welcome"===e&&this.renderSignupLink())}}const Er=(0,p.$j)((()=>({})),(e=>({tryAgainHandler:()=>{e(jt.abortLoginWithAccounts()),e(jt.enterWelcomeMode())},openLoginPage:()=>{e(jt.enterLoginMode())},openSignupPage:t=>e(jt.enterSignupMode(t)),openSettingsPage:()=>e(jt.enterSettingsMode()),onInteraction:(t,n,r,o,a)=>e(jt.interaction(t,n,r,o,a))})))(br);class yr extends l().PureComponent{render(){return l().createElement("header",{className:"Header"},l().createElement("h1",{className:"glue-hidden-visually"},"Spotify"),l().createElement("img",{className:"Header__logo",src:"images/logo.svg",alt:""}))}}var _r=n(1226),Sr=n(5989);class wr extends l().Component{renderFakeWebPlayer(){return l().createElement("div",{className:"fakeWebPlayer"},l().createElement("aside",null),l().createElement("footer",null,l().createElement("div",{className:"fakeWebPlayer__footer-left"}),l().createElement("div",{className:"fakeWebPlayer__footer-center"}),l().createElement("div",{className:"fakeWebPlayer__footer-right"})),l().createElement("main",null,l().createElement("div",{className:"fakeWebPlayer__content"})))}render(){const{loading:e,mode:t,loggedIn:n,previousMode:r,throbberDelay:o,signupStep:a,previousSignupStep:s}=this.props;if(e||!t)return l().createElement(Gt,{delay:o});if(n)return null;let i=r?`__${t} __${r}-to-${t}`:"";return"signup"===t&&Number.isInteger(s)&&(i+=` __signup_step_${s}_to_${a}`),l().createElement("main",{className:"App",key:"main1","data-ta-id":"login-app","data-ta-login-mode":t},this.renderFakeWebPlayer(),l().createElement("div",{className:`App__content ${i}`},l().createElement(Sr.Z,{mode:"in-out"},l().createElement(_r.Z,{timeout:{appear:0,enter:0,exit:650},key:i},l().createElement("div",{className:`App__modal ${i}`},l().createElement(yr,null),"welcome"===t&&l().createElement(Yt,null),"signup"===t&&l().createElement(Ln,{step:a}),"login"===t&&l().createElement(Vn,null),"open-browser"===t&&l().createElement(Hn,null),"settings"===t&&l().createElement(fr,null),l().createElement(Er,{mode:t}))))))}}f()(wr,"defaultProps",{throbberDelay:0,transitionLeaveTimeout:0});const kr=(0,p.$j)((e=>({mode:e.app.mode,previousMode:e.app.previousMode,signupStep:e.signup.step,previousSignupStep:e.signup.previousStep,loading:!!e.login.loading,loggedIn:!!e.login.loggedIn,throbberDelay:e.login.throbberDelay,transitionLeaveTimeout:e.login.redirectDelay})))(wr);var vr=n(3828),Or=n(3894);const Pr=$t().create().toString(),Cr="has-used-app",Tr=!window.localStorage.getItem(Cr);Tr&&window.localStorage.setItem(Cr,!0);const Ir=()=>{const e=V.getItem("utmParameters");let t;try{t=e?JSON.parse(e).referral:""}catch(e){t=""}return t};let Nr=null;var Dr=n(9798);function Ar({page:e}){Fr({page:e,action_type:"pageview",action_intent:""})}function Fr({page:e,action_type:t,action_intent:n,item_id:r,action_hash:o}){(function(){if(null===Nr)throw new Error("Missing `instance`. Have you called `setEventSenderInstance` yet?");return Nr})().send((0,Dr.e)({action_type:t,action_intent:n,action_page:e,action_item_id:r,action_hash:o,device_is_new_install:Tr,device_locale:window.__spotify.locale,device_referrer:Ir(),ab_flags:"",session_id:Pr}),{authorize:!1})}function Mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const Lr=e=>{window.location.href=e};function Rr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rr(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Ur={errorMessage:null};const jr=function(e=Ur,t){var n;switch(t.type){case jt.ENTER_SIGNUP_MODE:return xr(xr({},e),{},{previousMode:e.mode,mode:"signup"});case jt.ENTER_LOGIN_MODE:case jt.COUNTRY_NOT_LAUNCHED:return xr(xr({},e),{},{previousMode:e.mode,mode:"login"});case jt.ENTER_WELCOME_MODE:return xr(xr({},e),{},{previousMode:e.mode,mode:"welcome",errorMessage:null!==(n=t.errorMessage)&&void 0!==n?n:null});case jt.ENTER_SETTINGS_MODE:return xr(xr({},e),{},{previousMode:e.mode,mode:"settings"});default:return e}};function Gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Br(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gr(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const $r={proxy:{mode:0,address:"",username:"",password:""}};const Vr=function(e=$r,t){return function(e){return e.type===jt.SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS}(t)?Br(Br({},e),{},{proxy:{mode:t.data.mode,address:t.data.address,username:t.data.username,password:t.data.password}}):e};function Wr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wr(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Yr={step:0,isAttempting:!1,isSuccessful:void 0,errors:{},errorData:{},validated:{},formData:{name:"",email:"",password:"",birthDate:{day:void 0,month:void 0,year:void 0},gender:void 0,sendEmail:void 0,shareData:void 0,agreeEula:!1},restrictions:void 0};const Kr=function(e=Yr,t){switch(t.type){case jt.ENTER_SIGNUP_MODE_STEP_0:return Hr(Hr({},e),{},{previousStep:e.step,step:0});case jt.ENTER_SIGNUP_MODE_STEP_1:return Hr(Hr({},e),{},{previousStep:e.step,step:1});case jt.SIGNUP_RESTRICTIONS_SUCCESS:return Hr(Hr({},e),{},{formData:Hr(Hr({},e.formData),{},{sendEmail:!!t.restrictions.requires_marketing_opt_in_text||void 0,agreeEula:!!t.restrictions.pretick_eula}),restrictions:t.restrictions});case jt.SIGNUP_RESTRICTIONS_FAILURE:return Hr(Hr({},e),{},{errorData:t.error});case jt.SIGNUP_ATTEMPT:return Hr(Hr({},e),{},{isAttempting:!0,errorData:null});case jt.SIGNUP_SUCCESS:return Hr(Hr({},e),{},{isAttempting:!0,isSuccessful:!0,errorData:null});case jt.SIGNUP_FAILURE:return Hr(Hr({},e),{},{isAttempting:!1,isSuccessful:!1,errors:t.errors,errorData:null});case jt.FACEBOOK_SIGNUP_ATTEMPT:return Hr(Hr({},e),{},{errorData:null,errors:{}});case jt.FACEBOOK_SIGNUP_FAILURE:return Hr(Hr({},e),{},{errorData:t.errorData});case jt.VALIDATE_FIELD_ATTEMPT:return Hr(Hr({},e),{},{errors:Hr(Hr({},e.errors),{},{[t.field]:void 0})});case jt.VALIDATE_FIELD_FAILURE:return Hr(Hr({},e),{},{errors:Hr(Hr({},e.errors),{},{[t.field]:t.error}),validated:Hr(Hr({},e.validated),{},{[t.field]:!1})});case jt.VALIDATE_FIELD_SUCCESS:return Hr(Hr({},e),{},{errors:Hr(Hr({},e.errors),{},{[t.field]:void 0}),validated:Hr(Hr({},e.validated),{},{[t.field]:!0})});case jt.UPDATE_SIGNUP_DATA:{const n={};for(const e of Object.keys(t.data))n[e]=void 0;return Hr(Hr({},e),{},{errors:Hr(Hr({},e.errors),n),formData:Hr(Hr({},e.formData),t.data)})}case jt.CLEAR_ALL_ERRORS:return Hr(Hr({},e),{},{errors:{}});default:return e}};const qr=(0,vr.MT)((0,vr.UY)({app:jr,login:J,settings:Vr,signup:Kr}),void 0,(0,vr.md)(Or.Z,(e=>t=>n=>{const r=t(n);switch(n.type){case jt.START_APP:e.dispatch(jt.fetchUTMParameters()),e.dispatch(jt.getSignupRestrictions());!V.getItem("lastUsername")?e.dispatch(jt.enterWelcomeMode()):e.dispatch(jt.enterLoginMode());break;case jt.LOGIN_FAIL:{const t=e.getState();if(n.loginType===jt.LOGIN_TYPE_AUTOLOGIN){const n=t.app.mode;"welcome"===n?e.dispatch(jt.enterWelcomeMode()):"login"===n?e.dispatch(jt.enterLoginMode()):"signup"===n&&e.dispatch(jt.enterSignupMode())}else{if("open-browser"===t.app.mode){const r=n.errorData;let o=Zt(r.errorCategory,r.errorCode,r.errorReference);"desktop_login_accounts"===r.errorCategory&&4===r.errorCode&&(o="signup"===t.experimentWebAuthReducer.operationUsed?St.get("desktop-auth.login.signup-time-out"):St.get("desktop-auth.login.login-time-out")),o?e.dispatch(jt.enterWelcomeMode(o)):e.dispatch(jt.enterWelcomeMode())}}break}case jt.ENTER_SIGNUP_MODE:{const t=e.getState().signup.restrictions;t?!1===t.is_country_launched&&e.dispatch(jt.countryNotLaunched()):e.dispatch(jt.getSignupRestrictions());break}case jt.SIGNUP_RESTRICTIONS_SUCCESS:!1===n.restrictions.is_country_launched&&e.dispatch(jt.countryNotLaunched());break;case jt.SIGNUP_FAILURE:(n.errors.email||n.errors.password||n.errors.displayname)&&e.dispatch(jt.enterSignupModeStep0());break;case jt.COUNTRY_NOT_LAUNCHED:e.dispatch(jt.openSignupPage(!0))}return r}),(()=>e=>t=>{const n=e(t);switch(t.type){case jt.ENTER_LOGIN_MODE:Ar({page:"login"});break;case jt.LOGIN_SUCCESS:t.loginType===jt.LOGIN_TYPE_EMAIL?Fr({page:"login",action_type:"view",action_intent:"show-success-login-email"}):t.loginType===jt.LOGIN_TYPE_FACEBOOK&&Fr({page:"login",action_type:"view",action_intent:"show-success-login-facebook"});break;case jt.LOGIN_FAIL:t.loginType===jt.LOGIN_TYPE_EMAIL?t.errorData&&3===t.errorData.errorCode&&Fr({page:"login",action_type:"view",action_intent:"show-error-invalid-credential"}):t.loginType===jt.LOGIN_TYPE_FACEBOOK&&Fr({page:"login",action_type:"view",action_intent:"show-error-login-facebook"});break;case jt.ENTER_SIGNUP_MODE:Ar({page:"signup"});break;case jt.ENTER_SIGNUP_MODE_STEP_0:Fr({page:"signup",action_type:"view",action_intent:"show-signup-step-one"});break;case jt.ENTER_SIGNUP_MODE_STEP_1:Fr({page:"signup",action_type:"view",action_intent:"show-signup-step-two"});break;case jt.SIGNUP_SUCCESS:Fr({page:"signup",action_type:"view",action_intent:"show-success-signup-email"});break;case jt.SIGNUP_FAILURE:Fr({page:"signup",action_type:"view",action_intent:"show-error-signup-email",item_id:t.errors&&Object.keys(t.errors).join("|")});break;case jt.FACEBOOK_SIGNUP_SUCCESS:Fr({page:"signup",action_type:"view",action_intent:"show-success-authentication-facebook"});break;case jt.FACEBOOK_SIGNUP_FAILURE:Fr({page:"signup",action_type:"view",action_intent:"show-error-authentication-facebook",item_id:t.errorData&&`${t.errorData.errorCode} - ${t.errorData.errorDescription}`});break;case jt.ENTER_WELCOME_MODE:Ar({page:"login/welcome"});break;case jt.ENTER_SETTINGS_MODE:Ar({page:"login/settings"});break;case jt.INTERACTION:Fr({page:t.page,action_type:t.interactionType,action_intent:t.intent,item_id:t.itemId,action_hash:t.actionHash});break;case jt.VALIDATE_FIELD_FAILURE:if(t.error){const e=t.field,n=t.error.code;let r=null,o=null;"valueMissing"===n?r=`show-error-empty-${e}`:["incomplete","invalid","typeMismatch","tooShort"].includes(n)?r=`show-error-format-${e}`:(r=`show-error-${e}`,o=t.error.message||""),null!==r&&Fr(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({page:"signup",action_type:"view",action_intent:r},o?{item_id:o}:{}))}}return n}),(()=>e=>t=>{const n=e(t);if(!t.redirectTo)return n;let r;return"xpui"!==t.redirectTo||(r="spotify:app:xpui",t.redirectDelay?setTimeout((()=>{Lr(r)}),t.redirectDelay):Lr(r)),n})));qr.subscribe((()=>{const e=qr.getState();e.login.username&&localStorage.setItem(Y,e.login.username),e.login.utmParameters&&localStorage.setItem(q,JSON.stringify(e.login.utmParameters))}));const zr=qr;var Xr=n(2585),Zr=n(3626);let Jr=null;var Qr=n(349),eo=n(4978);(async function(){const e=window.__spotify.locale,t=await fetch(`i18n/${e}.json`).then((e=>e.json()));St.setLocale(e),St.setDictionary(t)})().then((async function(){const e=function(){const e=(0,Zr.qy)({providers:{endpoints:(0,Zr.uG)(),token:()=>null}});return e.connect(),e}();Jr=e;const t=((e,t,n)=>{if("event_sender_context_information"in e){const r=e.event_sender_context_information;return(0,Qr.mi)({transport:t,suppressPersist:!1,context:[(0,eo.UR)({version:r.client_version_string}),(0,eo.jx)(n),(0,eo.IE)(r.installation_id),(0,eo.Hv)({name:r.platform_type,version:r.os_version})]})}return(0,Qr.mi)({transport:t,suppressPersist:!1,context:[(0,eo.jx)(n),(0,eo.UR)({version:e.client_version_quadruple}),(0,eo.IE)(e.event_sender_installation_id_hex),(0,eo.Hv)({name:e.os_name,version:e.os_version})]})})(window.__spotify,e,"65b708073fc0480ea92a077233ca87bd");!function(e){Nr=e}(t),h.attach(),h.update(),g.attach();const n=document.location.search,r=new RegExp(`\\?param=error-code\\${encodeURIComponent("=")}([0-9]+)`,"i");window.addEventListener("message",(e=>{"critical-update-error"===e.data&&zr.dispatch(jt.loginFailed({errorCode:e.data}))}));const o=n.match(r);if(n&&o){const e=+o[1];zr.dispatch(jt.loginFailed({errorCode:e}))}let a="linux";window.navigator.platform.startsWith("Mac")&&(a="mac"),window.navigator.platform.startsWith("Win")&&(a="windows"),document.body.classList.add(`body-container--${a}`),d().render(l().createElement(u.zj,null,l().createElement(p.zt,{store:zr},l().createElement(kr,null))),document.getElementById("main")),zr.dispatch(jt.startApp()),document.documentElement.setAttribute("dir",window.__spotify.localization_is_rtl?"rtl":"ltr");const s={[Xr.PLATFORM_UNKNOWN]:"body-container--unknown-os",[Xr.PLATFORM_MAC]:"body-container--mac",[Xr.PLATFORM_WINDOWS]:"body-container--windows"},i=(0,Xr.getPlatform)();document.body.classList.add(s[i])}))},2585:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PLATFORM_UNKNOWN:()=>r,PLATFORM_MAC:()=>o,PLATFORM_WINDOWS:()=>a,isMac:()=>s,isWindows:()=>i,getPlatform:()=>l});const r=Symbol("PLATFORM_UNKNOWN"),o=Symbol("PLATFORM_MAC"),a=Symbol("PLATFORM_WINDOWS");function s(){return window.navigator.platform.startsWith("Mac")}function i(){return window.navigator.platform.startsWith("Win")}function l(){return s()?o:i()?a:r}},2976:(e,t)=>{let n=!1;t.update=()=>{},t.attach=()=>{if(n)return;n=!0;const e=window.__spotify&&window.__spotify.locale;e&&document.documentElement.setAttribute("lang",e)},t.detach=()=>{n&&(n=!1,document.documentElement.removeAttribute("lang"))}},685:(e,t,n)=>{const{getPlatform:r,PLATFORM_UNKNOWN:o,PLATFORM_MAC:a,PLATFORM_WINDOWS:s}=n(2585);let i=!1,l="always-visible",c=0;const d={[o]:"linux",[a]:"mac",[s]:"windows"};let u=d[o];function p(){const e=[...document.querySelectorAll("*")],t=[],n=["scroll","auto","overlay"];e.forEach((e=>{const r=window.getComputedStyle(e),o=r.overflowX,a=r.overflowY;n.includes(o)&&t.push({node:e,property:"overflow-x"}),n.includes(a)&&t.push({node:e,property:"overflow-y"})}));const r=document.createElement("style");r.innerHTML="\n    html::-webkit-scrollbar,\n    body::-webkit-scrollbar {\n      background-color: rgba(1, 2, 3, 0) !important;\n    }\n  ".trimRight();const o=`data-scrollbar-fix-${++c}-id`;let a=0;t.forEach((({node:e,property:t})=>{if(e!==document.body){const n=++a;e.setAttribute(o,n),r.innerHTML+=`\n    [${o}="${n}"] { ${t}: hidden !important; }`}})),document.head.appendChild(r),setTimeout((()=>{document.head.removeChild(r),t.forEach((({node:e})=>{e.removeAttribute(o)}))}),0)}t.performScrollBarFix=p,t.update=function(){},t.attach=function(){if(i)return;i=!0;const e=window.__spotify&&window.__spotify.scroller_style;l="overlay"===e?"overlay":"always-visible";const t=r();u=d[t],"always-visible"===l||"mac"!==u?(document.body.classList.remove("scrollbar-style-when-scrolling-mac"),document.body.classList.add(`scrollbar-style-visible-${u}`)):(document.body.classList.remove(`scrollbar-style-visible-${u}`),document.body.classList.add("scrollbar-style-when-scrolling-mac")),window.addEventListener("message",(e=>{"set_active"===e.data.name&&e.data.active&&p()}))},t.detach=function(){i&&(i=!1,c=0)}},4986:(e,t,n)=>{"use strict";n.d(t,{lX:()=>y,q_:()=>v,PP:()=>P,ob:()=>p,Ep:()=>u});var r=n(7462),o=n(8273),a=n(5429),s=n(2177);function i(e){return"/"===e.charAt(0)?e:`/${e}`}function l(e){return"/"===e.charAt(0)?e.substr(1):e}function c(e,t){return function(e,t){return new RegExp(`^${t}(\\/|\\?|#|$)`,"i").test(e)}(e,t)?e.substr(t.length):e}function d(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function u(e){const t=e.pathname,n=e.search,r=e.hash;let o=t||"/";return n&&"?"!==n&&(o+="?"===n.charAt(0)?n:`?${n}`),r&&"#"!==r&&(o+="#"===r.charAt(0)?r:`#${r}`),o}function p(e,t,n,a){let s;"string"==typeof e?(s=function(e){let t=e||"/",n="",r="";const o=t.indexOf("#");-1!==o&&(r=t.substr(o),t=t.substr(0,o));const a=t.indexOf("?");return-1!==a&&(n=t.substr(a),t=t.substr(0,a)),{pathname:t,search:"?"===n?"":n,hash:"#"===r?"":r}}(e),s.state=t):(s=(0,r.Z)({},e),void 0===s.pathname&&(s.pathname=""),s.search?"?"!==s.search.charAt(0)&&(s.search=`?${s.search}`):s.search="",s.hash?"#"!==s.hash.charAt(0)&&(s.hash=`#${s.hash}`):s.hash="",void 0!==t&&void 0===s.state&&(s.state=t));try{s.pathname=decodeURI(s.pathname)}catch(e){}return n&&(s.key=n),a?s.pathname?"/"!==s.pathname.charAt(0)&&(s.pathname=(0,o.Z)(s.pathname,a.pathname)):s.pathname=a.pathname:s.pathname||(s.pathname="/"),s}function g(){let e=null;let t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,r,o){if(null!=e){const a="function"==typeof e?e(t,n):e;"string"==typeof a?"function"==typeof r?r(a,o):o(!0):o(!1!==a)}else o(!0)},appendListener:function(e){let n=!0;function r(){n&&e.apply(void 0,arguments)}return t.push(r),function(){n=!1,t=t.filter((function(e){return e!==r}))}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.forEach((function(e){return e.apply(void 0,n)}))}}}const h=!("undefined"==typeof window||!window.document||!window.document.createElement);function m(e,t){t(window.confirm(e))}const f="popstate",b="hashchange";function E(){try{return window.history.state||{}}catch(e){return{}}}function y(e){void 0===e&&(e={}),h||(0,s.Z)(!1);const t=window.history,n=function(){const e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history}(),o=!(-1===window.navigator.userAgent.indexOf("Trident")),a=e,l=a.forceRefresh,y=void 0!==l&&l,_=a.getUserConfirmation,S=void 0===_?m:_,w=a.keyLength,k=void 0===w?6:w,v=e.basename?d(i(e.basename)):"";function O(e){const t=e||{},n=t.key,r=t.state,o=window.location;let a=o.pathname+o.search+o.hash;return v&&(a=c(a,v)),p(a,r,n)}function P(){return Math.random().toString(36).substr(2,k)}const C=g();function T(e){(0,r.Z)(G,e),G.length=t.length,C.notifyListeners(G.location,G.action)}function I(e){(function(e){void 0===e.state&&navigator.userAgent.indexOf("CriOS")})(e)||A(O(e.state))}function N(){A(O(E()))}let D=!1;function A(e){if(D)D=!1,T();else{const t="POP";C.confirmTransitionTo(e,t,S,(function(n){n?T({action:t,location:e}):function(e){const t=G.location;let n=M.indexOf(t.key);-1===n&&(n=0);let r=M.indexOf(e.key);-1===r&&(r=0);const o=n-r;o&&(D=!0,R(o))}(e)}))}}const F=O(E());var M=[F.key];function L(e){return v+u(e)}function R(e){t.go(e)}let x=0;function U(e){x+=e,1===x&&1===e?(window.addEventListener(f,I),o&&window.addEventListener(b,N)):0===x&&(window.removeEventListener(f,I),o&&window.removeEventListener(b,N))}let j=!1;var G={length:t.length,action:"POP",location:F,createHref:L,push:function(e,r){const o="PUSH",a=p(e,r,P(),G.location);C.confirmTransitionTo(a,o,S,(function(e){if(!e)return;const r=L(a),s=a.key,i=a.state;if(n)if(t.pushState({key:s,state:i},null,r),y)window.location.href=r;else{const e=M.indexOf(G.location.key),t=M.slice(0,-1===e?0:e+1);t.push(a.key),M=t,T({action:o,location:a})}else window.location.href=r}))},replace:function(e,r){const o="REPLACE",a=p(e,r,P(),G.location);C.confirmTransitionTo(a,o,S,(function(e){if(!e)return;const r=L(a),s=a.key,i=a.state;if(n)if(t.replaceState({key:s,state:i},null,r),y)window.location.replace(r);else{const e=M.indexOf(G.location.key);-1!==e&&(M[e]=a.key),T({action:o,location:a})}else window.location.replace(r)}))},go:R,goBack:function(){R(-1)},goForward:function(){R(1)},block:function(e){void 0===e&&(e=!1);const t=C.setPrompt(e);return j||(U(1),j=!0),function(){return j&&(j=!1,U(-1)),t()}},listen:function(e){const t=C.appendListener(e);return U(1),function(){U(-1),t()}}};return G}const _="hashchange",S={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:`!/${l(e)}`},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:l,decodePath:i},slash:{encodePath:i,decodePath:i}};function w(){const e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function k(e){const t=window.location.href.indexOf("#");window.location.replace(`${window.location.href.slice(0,t>=0?t:0)}#${e}`)}function v(e){void 0===e&&(e={}),h||(0,s.Z)(!1);const t=window.history,n=(window.navigator.userAgent.indexOf("Firefox"),e),o=n.getUserConfirmation,l=void 0===o?m:o,f=n.hashType,b=void 0===f?"slash":f,E=e.basename?d(i(e.basename)):"",y=S[b],v=y.encodePath,O=y.decodePath;function P(){let e=O(w());return E&&(e=c(e,E)),p(e)}const C=g();function T(e){(0,r.Z)(G,e),G.length=t.length,C.notifyListeners(G.location,G.action)}let I=!1,N=null;function D(){const e=w(),t=v(e);if(e!==t)k(t);else{const e=P(),t=G.location;if(!I&&(r=e,(n=t).pathname===r.pathname&&n.search===r.search&&n.hash===r.hash&&n.key===r.key&&(0,a.Z)(n.state,r.state)))return;if(N===u(e))return;N=null,function(e){if(I)I=!1,T();else{const t="POP";C.confirmTransitionTo(e,t,l,(function(n){n?T({action:t,location:e}):function(e){const t=G.location;let n=L.lastIndexOf(u(t));-1===n&&(n=0);let r=L.lastIndexOf(u(e));-1===r&&(r=0);const o=n-r;o&&(I=!0,R(o))}(e)}))}}(e)}var n,r}const A=w(),F=v(A);A!==F&&k(F);const M=P();var L=[u(M)];function R(e){t.go(e)}let x=0;function U(e){x+=e,1===x&&1===e?window.addEventListener(_,D):0===x&&window.removeEventListener(_,D)}let j=!1;var G={length:t.length,action:"POP",location:M,createHref:function(e){return`#${v(E+u(e))}`},push:function(e,t){const n="PUSH",r=p(e,void 0,void 0,G.location);C.confirmTransitionTo(r,n,l,(function(e){if(!e)return;const t=u(r),o=v(E+t);if(w()!==o){N=t,function(e){window.location.hash=e}(o);const e=L.lastIndexOf(u(G.location)),a=L.slice(0,-1===e?0:e+1);a.push(t),L=a,T({action:n,location:r})}else T()}))},replace:function(e,t){const n="REPLACE",r=p(e,void 0,void 0,G.location);C.confirmTransitionTo(r,n,l,(function(e){if(!e)return;const t=u(r),o=v(E+t);w()!==o&&(N=t,k(o));const a=L.indexOf(u(G.location));-1!==a&&(L[a]=t),T({action:n,location:r})}))},go:R,goBack:function(){R(-1)},goForward:function(){R(1)},block:function(e){void 0===e&&(e=!1);const t=C.setPrompt(e);return j||(U(1),j=!0),function(){return j&&(j=!1,U(-1)),t()}},listen:function(e){const t=C.appendListener(e);return U(1),function(){U(-1),t()}}};return G}function O(e,t,n){return Math.min(Math.max(e,t),n)}function P(e){void 0===e&&(e={});const t=e,n=t.getUserConfirmation,o=t.initialEntries,a=void 0===o?["/"]:o,s=t.initialIndex,i=void 0===s?0:s,l=t.keyLength,c=void 0===l?6:l,d=g();function h(e){(0,r.Z)(_,e),_.length=_.entries.length,d.notifyListeners(_.location,_.action)}function m(){return Math.random().toString(36).substr(2,c)}const f=O(i,0,a.length-1),b=a.map((function(e){return p(e,void 0,"string"==typeof e?m():e.key||m())})),E=u;function y(e){const t=O(_.index+e,0,_.entries.length-1),r=_.entries[t];d.confirmTransitionTo(r,"POP",n,(function(e){e?h({action:"POP",location:r,index:t}):h()}))}var _={length:b.length,action:"POP",location:b[f],index:f,entries:b,createHref:E,push:function(e,t){const r="PUSH",o=p(e,t,m(),_.location);d.confirmTransitionTo(o,r,n,(function(e){if(!e)return;const t=_.index+1,n=_.entries.slice(0);n.length>t?n.splice(t,n.length-t,o):n.push(o),h({action:r,location:o,index:t,entries:n})}))},replace:function(e,t){const r="REPLACE",o=p(e,t,m(),_.location);d.confirmTransitionTo(o,r,n,(function(e){e&&(_.entries[_.index]=o,h({action:r,location:o}))}))},go:y,goBack:function(){y(-1)},goForward:function(){y(1)},canGo:function(e){const t=_.index+e;return t>=0&&t<_.entries.length},block:function(e){return void 0===e&&(e=!1),d.setPrompt(e)},listen:function(e){return d.appendListener(e)}};return _}}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,r),a.exports}r.m=t,r.amdO={},e=[],r.O=(t,n,o,a)=>{if(!n){var s=1/0;for(d=0;d<e.length;d++){for(var[n,o,a]=e[d],i=!0,l=0;l<n.length;l++)(!1&a||s>=a)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(i=!1,a<s&&(s=a));if(i){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,o,a]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={535:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[s,i,l]=n,c=0;if(s.some((t=>0!==e[t]))){for(o in i)r.o(i,o)&&(r.m[o]=i[o]);if(l)var d=l(r)}for(t&&t(n);c<s.length;c++)a=s[c],r.o(e,a)&&e[a]&&e[a][0](),e[s[c]]=0;return r.O(d)},n=("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=r.O(void 0,[569],(()=>r(3982)));o=r.O(o)})();
//# sourceMappingURL=login.js.map